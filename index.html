<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="http://knexjs.org" />
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" />
    <link rel="icon" type="image/png" href="/assets/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/assets/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="manifest" href="/assets/favicons/manifest.json" />
    <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#e16426" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="stylesheet" href="/build/bundle.css" />
    <title>Knex.js - A SQL Query Builder for Javascript</title>
</head>

<body>
    <div id="documentation">
        <div>
            <div id="sidebar" class="interface"><a class="toc_title" href="#changelog">Knex.js <span class="version">(0.11.9)</span></a>
                <ul class="toc_section">
                    <li>» <a href="https://github.com/tgriesser/knex">GitHub Repository</a></li>
                    <li>» <a href="#support">Support</a></li>
                    <li>» <a href="#faq">FAQ</a></li>
                    <li>» <a href="#changelog">Change Log</a></li>
                </ul><a class="toc_title" href="#Upgrading">Upgrading</a>
                <ul class="toc_section">
                    <li>– <a href="#Upgrading-from0.10">0.10.x -&gt; 0.11</a></li>
                    <li>– <a href="#Upgrading-from0.9">0.9.x -&gt; 0.10</a></li>
                </ul><a class="toc_title" href="#Installation">Installation</a>
                <ul class="toc_section">
                    <li>– <a href="#Installation-node">Node.js</a></li>
                    <li>– <a href="#Installation-browser">Browser</a></li>
                    <li><b><a href="#Installation-client">Config Options:</a></b></li>
                    <li>  – <a href="#Installation-client">client</a></li>
                    <li>  – <a href="#Installation-debug">debug</a></li>
                    <li>  – <a href="#Installation-pooling">pooling</a></li>
                    <li>  – <a href="#Installation-acquireConnectionTimeout">acquireConnectionTimeout</a></li>
                    <li>  – <a href="#Installation-migrations">migrations</a></li>
                </ul><a class="toc_title" href="#Builder">Query Builder</a>
                <ul class="toc_section">
                    <li>– <a href="#Builder-knex"><b>constructor</b></a></li>
                    <li>– <a href="#Builder-timeout">timeout</a></li>
                    <li>– <a href="#Builder-select">select</a></li>
                    <li>– <a href="#Builder-as">as</a></li>
                    <li>– <a href="#Builder-column">column</a></li>
                    <li>– <a href="#Builder-from">from</a></li>
                    <li>– <a href="#Builder-withSchema">withSchema</a></li>
                    <li><b><a href="#Builder-wheres">Where Methods:</a></b></li>
                    <li>  - <a href="#Builder-where">where</a></li>
                    <li>  - <a href="#Builder-whereNot">whereNot</a></li>
                    <li>  - <a href="#Builder-whereIn">whereIn</a></li>
                    <li>  - <a href="#Builder-whereNotIn">whereNotIn</a></li>
                    <li>  - <a href="#Builder-whereNull">whereNull</a></li>
                    <li>  - <a href="#Builder-whereNotNull">whereNotNull</a></li>
                    <li>  - <a href="#Builder-whereExists">whereExists</a></li>
                    <li>  - <a href="#Builder-whereNotExists">whereNotExists</a></li>
                    <li>  - <a href="#Builder-whereBetween">whereBetween</a></li>
                    <li>  - <a href="#Builder-whereNotBetween">whereNotBetween</a></li>
                    <li>  - <a href="#Builder-whereRaw">whereRaw</a></li>
                    <li><b><a href="#Builder-join">Join Methods:</a></b></li>
                    <li>  – <a href="#Builder-innerJoin">innerJoin</a></li>
                    <li>  – <a href="#Builder-leftJoin">leftJoin</a></li>
                    <li>  – <a href="#Builder-leftOuterJoin">leftOuterJoin</a></li>
                    <li>  – <a href="#Builder-rightJoin">rightJoin</a></li>
                    <li>  – <a href="#Builder-rightOuterJoin">rightOuterJoin</a></li>
                    <li>  – <a href="#Builder-outerJoin">outerJoin</a></li>
                    <li>  – <a href="#Builder-fullOuterJoin">fullOuterJoin</a></li>
                    <li>  – <a href="#Builder-crossJoin">crossJoin</a></li>
                    <li>  – <a href="#Builder-joinRaw">joinRaw</a></li>
                    <li>– <a href="#Builder-distinct">distinct</a></li>
                    <li>– <a href="#Builder-groupBy">groupBy</a></li>
                    <li>– <a href="#Builder-groupByRaw">groupByRaw</a></li>
                    <li>– <a href="#Builder-orderBy">orderBy</a></li>
                    <li>– <a href="#Builder-orderByRaw">orderByRaw</a></li>
                    <li>– <a href="#Builder-having">having</a></li>
                    <li>– <a href="#Builder-offset">offset</a></li>
                    <li>– <a href="#Builder-limit">limit</a></li>
                    <li>– <a href="#Builder-union">union</a></li>
                    <li>– <a href="#Builder-unionAll">unionAll</a></li>
                    <li>– <a href="#Builder-insert">insert</a></li>
                    <li>– <a href="#Builder-returning">returning</a></li>
                    <li>– <a href="#Builder-update">update</a></li>
                    <li>– <a href="#Builder-del">del / delete</a></li>
                    <li>– <a href="#Builder-transacting">transacting</a></li>
                    <li>  – <a href="#Builder-forUpdate">forUpdate</a></li>
                    <li>  – <a href="#Builder-forShare">forShare</a></li>
                    <li>– <a href="#Builder-count">count</a></li>
                    <li>– <a href="#Builder-min">min</a></li>
                    <li>– <a href="#Builder-max">max</a></li>
                    <li>– <a href="#Builder-sum">sum</a></li>
                    <li>– <a href="#Builder-avg">avg</a></li>
                    <li>– <a href="#Builder-increment">increment</a></li>
                    <li>– <a href="#Builder-decrement">decrement</a></li>
                    <li>– <a href="#Builder-truncate">truncate</a></li>
                    <li>– <a href="#Builder-pluck">pluck</a></li>
                    <li>– <a href="#Builder-first">first</a></li>
                    <li>– <a href="#Builder-clone">clone</a></li>
                    <li>– <a href="#Builder-modify">modify</a></li>
                    <li>– <a href="#Builder-columnInfo">columnInfo</a></li>
                    <li>– <a href="#Builder-debug">debug</a></li>
                    <li>– <a href="#Builder-connection">connection</a></li>
                    <li>– <a href="#Builder-options">options</a></li>
                </ul><a class="toc_title" href="#Transactions">Transactions</a>
                <ul class="toc_section">
                    <li>– <a href="#Transactions"><b>overview</b></a></li>
                </ul><a class="toc_title" href="#Schema">Schema Builder</a>
                <ul class="toc_section">
                    <li>– <a href="#Schema-withSchema">withSchema</a></li>
                    <li>– <a href="#Schema-createTable">createTable</a></li>
                    <li>– <a href="#Schema-createTableIfNotExists">createTableIfNotExists</a></li>
                    <li>– <a href="#Schema-renameTable">renameTable</a></li>
                    <li>– <a href="#Schema-dropTable">dropTable</a></li>
                    <li>– <a href="#Schema-hasColumn">hasColumn</a></li>
                    <li>– <a href="#Schema-hasTable">hasTable</a></li>
                    <li>– <a href="#Schema-dropTableIfExists">dropTableIfExists</a></li>
                    <li>– <a href="#Schema-table">table</a></li>
                    <li>– <a href="#Schema-raw">raw</a></li>
                    <li><b><a href="#Schema-Building">Schema Building:</a></b></li>
                    <li>– <a href="#Schema-dropColumn">dropColumn</a></li>
                    <li>– <a href="#Schema-dropColumns">dropColumns</a></li>
                    <li>– <a href="#Schema-renameColumn">renameColumn</a></li>
                    <li>– <a href="#Schema-increments">increments</a></li>
                    <li>– <a href="#Schema-integer">integer</a></li>
                    <li>– <a href="#Schema-bigInteger">bigInteger</a></li>
                    <li>– <a href="#Schema-text">text</a></li>
                    <li>– <a href="#Schema-string">string</a></li>
                    <li>– <a href="#Schema-float">float</a></li>
                    <li>– <a href="#Schema-decimal">decimal</a></li>
                    <li>– <a href="#Schema-boolean">boolean</a></li>
                    <li>– <a href="#Schema-date">date</a></li>
                    <li>– <a href="#Schema-dateTime">dateTime</a></li>
                    <li>– <a href="#Schema-time">time</a></li>
                    <li>– <a href="#Schema-timestamp">timestamp</a></li>
                    <li>– <a href="#Schema-timestamps">timestamps</a></li>
                    <li>– <a href="#Schema-dropTimestamps">dropTimestamps</a></li>
                    <li>– <a href="#Schema-binary">binary</a></li>
                    <li>– <a href="#Schema-enum">enum / enu</a></li>
                    <li>– <a href="#Schema-json">json</a></li>
                    <li>– <a href="#Schema-jsonb">jsonb</a></li>
                    <li>– <a href="#Schema-uuid">uuid</a></li>
                    <li>– <a href="#Schema-comment">comment</a></li>
                    <li>– <a href="#Schema-engine">engine</a></li>
                    <li>– <a href="#Schema-charset">charset</a></li>
                    <li>– <a href="#Schema-collate">collate</a></li>
                    <li>– <a href="#Schema-inherits">inherits</a></li>
                    <li>– <a href="#Schema-specificType">specificType</a></li>
                    <li>– <a href="#Schema-index">index</a></li>
                    <li>– <a href="#Schema-dropIndex">dropIndex</a></li>
                    <li>– <a href="#Schema-foreign">foreign</a></li>
                    <li>– <a href="#Schema-dropForeign">dropForeign</a></li>
                    <li>– <a href="#Schema-dropUnique">dropUnique</a></li>
                    <li>– <a href="#Schema-dropPrimary">dropPrimary</a></li>
                    <li><a href="#Chainable"><b>Chainable:</b></a></li>
                    <li>– <a href="#Chainable-index">index</a></li>
                    <li>– <a href="#Chainable-primary">primary</a></li>
                    <li>– <a href="#Chainable-unique">unique</a></li>
                    <li>– <a href="#Chainable-references">references</a></li>
                    <li>– <a href="#Chainable-inTable">inTable</a></li>
                    <li>– <a href="#Chainable-onDelete">onDelete</a></li>
                    <li>– <a href="#Chainable-onUpdate">onUpdate</a></li>
                    <li>– <a href="#Chainable-defaultTo">defaultTo</a></li>
                    <li>– <a href="#Chainable-unsigned">unsigned</a></li>
                    <li>– <a href="#Chainable-notNullable">notNullable</a></li>
                    <li>– <a href="#Chainable-nullable">nullable</a></li>
                    <li>– <a href="#Chainable-first">first</a></li>
                    <li>– <a href="#Chainable-after">after</a></li>
                    <li>– <a href="#Chainable-comment">comment</a></li>
                    <li>– <a href="#Chainable-collate">collate</a></li>
                </ul><a class="toc_title" href="#Raw">Raw</a>
                <ul class="toc_section">
                    <li>– <a href="#Raw-Bindings">Raw Parameter Binding</a></li>
                    <li>– <a href="#Raw-Expressions">Raw Expressions</a></li>
                    <li>– <a href="#Raw-Queries">Raw Queries</a></li>
                    <li>- <a href="#Raw-queries-wrapped">Wrapped Queries</a></li>
                </ul><a class="toc_title" href="#Utility">Utility</a>
                <ul class="toc_section">
                    <li>- <a href="#Utility-BatchInsert">Batch Insert</a></li>
                </ul><a class="toc_title" href="#Interfaces">Interfaces</a>
                <ul class="toc_section">
                    <li><b><a href="#Interfaces-Promises">Promises</a></b></li>
                    <li>  – <a href="#Promises-then">then</a></li>
                    <li>  – <a href="#Promises-catch">catch</a></li>
                    <li>  – <a href="#Promises-tap">tap</a></li>
                    <li>  – <a href="#Promises-map">map</a></li>
                    <li>  – <a href="#Promises-reduce">reduce</a></li>
                    <li>  – <a href="#Promises-bind">bind</a></li>
                    <li>  – <a href="#Promises-return">return</a></li>
                    <li><b><a href="#Interfaces-Callbacks">Callbacks</a></b></li>
                    <li>  – <a href="#Interfaces-asCallback">asCallback</a></li>
                    <li><b><a href="#Interfaces-Streams">Streams</a></b></li>
                    <li>  – <a href="#Streams-stream">stream</a></li>
                    <li>  – <a href="#Streams-pipe">pipe</a></li>
                    <li><b><a href="#Interfaces-Events">Events</a></b></li>
                    <li>  – <a href="#Events-query">query</a></li>
                    <li>  – <a href="#Events-query-error">query-error</a></li>
                    <li>  – <a href="#Events-query-response">query-response</a></li>
                    <li><b><a href="#Interfaces-Other">Other:</a></b></li>
                    <li>  – <a href="#Other-toString">toString</a></li>
                    <li>  – <a href="#Other-toSQL">toSQL</a></li>
                </ul><a class="toc_title" href="#Migrations">Migrations</a>
                <ul class="toc_section">
                    <li><a href="#Migrations-CLI"><b>CLI</b></a></li>
                    <li>– <a href="#Migrations-CLI">Migrations</a></li>
                    <li>– <a href="#Seeds-CLI">Seed files</a></li>
                    <li>– <a href="#knexfile">knexfile.js</a></li>
                    <li><a href="#Migrations-API"><b>Migration API</b></a></li>
                    <li>– <a href="#Migrations-make">make</a></li>
                    <li>– <a href="#Migrations-latest">latest</a></li>
                    <li>– <a href="#Migrations-rollback">rollback</a></li>
                    <li>– <a href="#Migrations-currentVersion">currentVersion</a></li>
                    <li><a href="#Seeds-API"><b>Seed API</b></a></li>
                    <li>– <a href="#Seeds-make">make</a></li>
                    <li>– <a href="#Seeds-run">run</a></li>
                </ul><a class="toc_title" href="#support">Support</a><a class="toc_title" href="#faq">F.A.Q.</a><a class="toc_title" href="#changelog">Change Log</a></div>
            <div class="language">Show example query output as:
                <br/>
                <select>
                    <option selected="" value="mysql">MySQL / MariaDB</option>
                    <option value="pg">PostgreSQL</option>
                    <option value="sqlite3">SQLite3</option>
                    <option value="oracle">Oracle</option>
                    <option value="mssql">MSSQL</option>
                </select>
            </div>
            <a href="https://github.com/tgriesser/knex"><img style="position:fixed;top:0;right:0;border:0;" src="assets/images/github.png" alt="Fork me on GitHub" /></a>
            <div class="container">
                <div id="Prelude">
                    <div>
                        <p><img height="108" id="logo" src="assets/images/knex.png" alt="Knex.js" /></p>
                        <p><strong>Knex.js</strong> is a &quot;batteries included&quot; SQL query builder for <strong>Postgres</strong>, <strong>MSSQL</strong>, <strong>MySQL</strong>, <strong>MariaDB</strong>, <strong>SQLite3</strong>, and <strong>Oracle</strong> designed to be flexible, portable, and fun to use. It features both traditional node style <a href="#Interfaces-Callbacks">callbacks</a> as well as a <a href="#Interfaces-Promises">promise</a> interface for cleaner async flow control, <a href="#Interfaces-Streams">a stream interface</a>, full featured <a href="#Builder">query</a> and <a href="#Schema">schema</a> builders, <a href="#Transactions"><strong>transaction support (with savepoints)</strong></a>, connection <a href="#Installation-pooling">pooling</a> and standardized responses between different query clients and dialects.</p>
                        <p>The project is <a href="http://github.com/tgriesser/knex">hosted on GitHub</a>, and has a comprehensive <a href="https://travis-ci.org/tgriesser/knex">test suite</a>.</p>
                        <p>Knex is available for use under the <a href="http://github.com/tgriesser/knex/blob/master/LICENSE">MIT software license</a>.</p>
                        <p>You can report bugs and discuss features on the <a href="http://github.com/tgriesser/knex/issues">GitHub issues page</a>, add pages to the <a href="https://github.com/tgriesser/knex/wiki">wiki</a> or send tweets to <a href="http://twitter.com/tgriesser">@tgriesser</a>.</p>
                        <p>Thanks to all of the great <a href="https://github.com/tgriesser/knex/graphs/contributors">contributions</a> to the project.</p>
                    </div>
                    <p class="info">Special thanks to <a href="https://twitter.com/taylorotwell">Taylor Otwell</a> and his work on the <a href="http://laravel.com/docs/queries">Laravel Query Builder</a>, from which much of the builder&#39;s code and syntax was originally derived.</p>
                    <h2>Latest Release: 0.11.9 - <span class="small"><a href="#changelog">Change Log</a></span></h2>
                    <p>Current Develop —
                        <a href="https://travis-ci.org/tgriesser/knex"><img src="https://travis-ci.org/tgriesser/knex.png?branch=master" alt="Travis Badge"></a>
                    </p>
                </div>
                <div id="Upgrading">
                    <h2 id="Upgrading">Upgrading</h2>
                    <h3 id="Upgrading-from0.10">Upgrading 0.10 -&gt; 0.11</h3>
                    <p>Knex treats <code>orWhere</code> with multiple keyed arguments differently. See Changelog.</p>
                    <h3 id="Upgrading-from0.9">Upgrading 0.9 -&gt; 0.10</h3>
                    <p>Knex will no longer interpret <code>undefined</code> values as <code>null</code> for <code>insert</code> or <code>update</code>. See changelog for links to relevant issues.</p>
                </div>
                <div id="Installation">
                    <h2 id="Installation">Installation</h2>
                    <p>Knex can be used as an SQL query builder in both Node.JS and the browser, limited to WebSQL&#39;s constraints (like the inability to drop tables or read schemas). Composing SQL queries in the browser for execution on the server is highly discouraged, as this can be the cause of serious security vulnerabilities. The browser builds outside of WebSQL are primarily for learning purposes - for example, you can pop open the console and build queries on this page using the <a href="javascript:alert(pg">pg</a>), <a href="javascript:alert(mysql">mysql</a>), and <a href="javascript:alert(sqlite3">sqlite3</a>) objects.</p>
                    <h3 id="Installation-node">Node.js</h3>
                    <p>The primary target environment for Knex is Node.js, you will need to install the <code>knex</code> library, and then install the appropriate database library: <a href="https://github.com/brianc/node-postgres"><code>pg</code></a> for PostgreSQL, <a href="https://github.com/felixge/node-mysql"><code>mysql</code></a> for MySQL or MariaDB, <a href="https://github.com/mapbox/node-sqlite3"><code>sqlite3</code></a> for SQLite3, or <a href="https://github.com/patriksimek/node-mssql"><code>mssql</code></a> for MSSQL.</p><pre><code>$ npm install knex --save

# Then add one of the following (adding a --save) flag:
$ npm install pg
$ npm install sqlite3
$ npm install mysql
$ npm install mysql2
$ npm install mariasql
$ npm install strong-oracle
$ npm install oracle
$ npm install mssql</code></pre>
                    <h3 id="Installation-browser">Browser</h3>
                    <p>Knex can be built using browserify or webpack, and a pre-built version can be found in the <a href="https://github.com/tgriesser/knex/tree/master/build">build directory</a>. View source on this page to see the browser build in-action.</p>
                    <h3 id="Installation-client">Initializing the Library</h3>
                    <p>The <code>knex</code> module is itself a function which takes a configuration object for Knex, accepting a few parameters. The <code>client</code> parameter is required and determines which client adapter will be used with the library.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({
client: <span class="hljs-string">'mysql'</span>,
connection: {
  host : <span class="hljs-string">'127.0.0.1'</span>,
  user : <span class="hljs-string">'your_database_user'</span>,
  password : <span class="hljs-string">'your_database_password'</span>,
  database : <span class="hljs-string">'myapp_test'</span>
}
});</code></pre>
                    <p>The connection options are passed directly to the appropriate database client to create the connection, and may be either an object, or a connection string:</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> pg = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({ client: <span class="hljs-string">'pg'</span>, connection: process.env.PG_CONNECTION_STRING, searchPath: <span class="hljs-string">'knex,public'</span> });</code></pre>
                    <p class="info">Note: When you use the SQLite3 adapter, there is a filename required, not a network connection. For example:</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({
client: <span class="hljs-string">'sqlite3'</span>,
connection: {
  filename: <span class="hljs-string">"./mydb.sqlite"</span>
}
});</code></pre>
                    <p>You can also connect via an unix domain socket, which will ignore host and port.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({
client: <span class="hljs-string">'mysql'</span>,
connection: {
  socketPath : <span class="hljs-string">'/path/to/socket.sock'</span>,
  user : <span class="hljs-string">'your_database_user'</span>,
  password : <span class="hljs-string">'your_database_password'</span>,
  database : <span class="hljs-string">'myapp_test'</span>
}
});</code></pre>
                    <p class="info">Initializing the library should normally only ever happen once in your application, as it creates a connection pool for the current database, you should use the instance returned from the initialize call throughout your library.</p>
                    <p>You can even use knex without a connection, just for its query building features. Just pass in an empty object when initializing the library. Specify a client if you are interested in a particular flavour of SQL.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({});
<span class="hljs-keyword">var</span> pg = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({client: <span class="hljs-string">'pg'</span>});
knex(<span class="hljs-string">'table'</span>).insert({a: <span class="hljs-string">'b'</span>}).returning(<span class="hljs-string">'*'</span>).toString();
<span class="hljs-comment">// "insert into "table" ("a") values ('b')"</span>

pg(<span class="hljs-string">'table'</span>).insert({a: <span class="hljs-string">'b'</span>}).returning(<span class="hljs-string">'*'</span>).toString();
<span class="hljs-comment">// "insert into "table" ("a") values ('b') returning *"</span></code></pre>
                    <h3 id="Installation-debug">Debugging</h3>
                    <p>Passing a <code>debug: true</code> flag on your initialization object will turn on <a href="#Builder-debug">debugging</a> for all queries.</p>
                    <h3 id="Installation-pooling">Pooling</h3>
                    <div>
                        <p>The client created by the configuration initializes a connection pool, using the <a href="https://github.com/myndzi/pool2">Pool2</a> library. This connection pool has a default setting of a <code>min: 2, max: 10</code> for the MySQL and PG libraries, and a single connection for sqlite3 (due to issues with utilizing multiple connections on a single file). To change the config settings for the pool, pass a <code>pool</code> option as one of the keys in the initialize block.</p>
                        <p>The default connection pool also applies a <code>ping</code> function to verify that a connection is still alive by running a <code>SELECT 1</code> query. If you don&#39;t want this check you may supply your own ping function to overwrite knex&#39;s default behavior.</p>
                        <p>Checkout the <a href="https://github.com/myndzi/pool2">Pool2</a> library for more information.</p>
                    </div><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({
client: <span class="hljs-string">'mysql'</span>,
connection: {
  host : <span class="hljs-string">'127.0.0.1'</span>,
  user : <span class="hljs-string">'your_database_user'</span>,
  password : <span class="hljs-string">'your_database_password'</span>,
  database : <span class="hljs-string">'myapp_test'</span>
},
pool: { min: <span class="hljs-number">0</span>, max: <span class="hljs-number">7</span> }
});</code></pre>
                    <p>If you ever need to explicitly teardown the connection pool, you may use <code>knex.destroy([callback])</code>. You may use <code>knex.destroy</code> by passing a callback, or by chaining as a promise, just not both.</p>
                    <h3 id="Installation-acquireConnectionTimeout">acquireConnectionTimeout</h3>
                    <p><code>acquireConnectionTimeout</code> defaults to 60000ms and is used to determine how long knex should wait before throwing a timeout error when acquiring a connection is not possible. The most common cause for this is using up all the pool for transaction connections and then attempting to run queries outside of transactions while the pool is still full. The error thrown will provide information on the query the connection was for to simplify the job of locating the culprit.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({
client: <span class="hljs-string">'pg'</span>,
connection: {...},
pool: {...},
acquireConnectionTimeout: <span class="hljs-number">10000</span>
});</code></pre>
                    <h3 id="Installation-migrations">Migrations</h3>
                    <p>For convenience, the any migration configuration may be specified when initializing the library. Read the <a href="#Migrations">Migrations</a> section for more information and a full list of configuration options.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({
client: <span class="hljs-string">'mysql'</span>,
connection: {
  host : <span class="hljs-string">'127.0.0.1'</span>,
  user : <span class="hljs-string">'your_database_user'</span>,
  password : <span class="hljs-string">'your_database_password'</span>,
  database : <span class="hljs-string">'myapp_test'</span>
},
migrations: {
  tableName: <span class="hljs-string">'migrations'</span>
}
});</code></pre></div>
                <div id="Builder">
                    <h2 id="Builder">Knex Query Builder</h2>
                    <p>The heart of the library, the knex query builder is the interface used for building and executing standard SQL queries, such as <code>select</code>, <code>insert</code>, <code>update</code>, <code>delete</code>.</p>
                    <div id="Builder-knex"><b>knex</b> — <code>knex(tableName) / knex.[methodName]</code>
                        <p>The query builder starts off either by specifying a tableName you wish to query against, or by calling any method directly on the knex object. This kicks off a jQuery-like chain, with which you can call additional query builder methods as needed to construct the query, eventually calling any of the interface methods, to either convert toString, or execute the query with a promise, callback, or stream.</p>
                    </div>
                    <div id="Builder-timeout"><b>timeout</b> — <code>.timeout(ms, options={cancel: boolean})</code>
                        <p>Sets a timeout for the query and will throw a TimeoutError if the timeout is exceeded. The error contains information about the query, bindings, and the timeout that was set. Useful for complex queries that you want to make sure are not taking too long to execute. Optional second argument for passing options:* **cancel**: if `true`, cancel query if timeout is reached. **NOTE:** only supported in MySQL and MariaDB for now.</p><pre class="display"><code class="js hljs">knex.select().from(<span class="hljs-string">'books'</span>).timeout(<span class="hljs-number">1000</span>)</code></pre><pre class="display"><code class="js hljs">knex.select().from(<span class="hljs-string">'books'</span>).timeout(<span class="hljs-number">1000</span>, {cancel: <span class="hljs-literal">true</span>}) <span class="hljs-comment">// MySQL and MariaDB only</span></code></pre></div>
                    <div id="Builder-select"><b>select</b> — <code>.select([*columns])</code>
                        <p>Creates a select query, taking an optional array of columns for the query, eventually defaulting to * if none are specified when the query is built. The response of a select call will resolve with an array of objects selected from the database.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'title'</span>, <span class="hljs-string">'author'</span>, <span class="hljs-string">'year'</span>).from(<span class="hljs-string">'books'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select().table(<span class="hljs-string">'books'</span>)</code></pre></div>
                    <div id="Builder-as"><b>as</b> — <code>.as(name)</code>
                        <p>Allows for aliasing a subquery, taking the string you wish to name the current query. If the query is not a sub-query, it will be ignored.</p><pre class="display"><code class="js hljs">knex.avg(<span class="hljs-string">'sum_column1'</span>).from(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.sum(<span class="hljs-string">'column1 as sum_column1'</span>).from(<span class="hljs-string">'t1'</span>).groupBy(<span class="hljs-string">'column1'</span>).as(<span class="hljs-string">'t1'</span>)
}).as(<span class="hljs-string">'ignored_alias'</span>)</code></pre></div>
                    <div id="Builder-column"><b>column</b> — <code>.column(columns)</code>
                        <p>Specifically set the columns to be selected on a select query, taking an array or a list of of column names.</p><pre class="display"><code class="js hljs">knex.column(<span class="hljs-string">'title'</span>, <span class="hljs-string">'author'</span>, <span class="hljs-string">'year'</span>).select().from(<span class="hljs-string">'books'</span>)</code></pre><pre class="display"><code class="js hljs">knex.column([<span class="hljs-string">'title'</span>, <span class="hljs-string">'author'</span>, <span class="hljs-string">'year'</span>]).select().from(<span class="hljs-string">'books'</span>)</code></pre></div>
                    <div id="Builder-from"><b>from</b> — <code>.from([tableName])</code>
                        <p>Specifies the table used in the current query, replacing the current table name if one has already been specified. This is typically used in the sub-queries performed in the advanced where or union methods.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>)</code></pre></div>
                    <div id="Builder-withSchema"><b>withSchema</b> — <code>.withSchema([schemaName])</code>
                        <p>Specifies the schema to be used as prefix of table name.</p><pre class="display"><code class="js hljs">knex.withSchema(<span class="hljs-string">'public'</span>).select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>)</code></pre></div>
                    <h3 id="Builder-wheres">Where Clauses</h3>
                    <div>
                        <p>Several methods exist to assist in dynamic where clauses. In many places functions may be used in place of values, constructing subqueries. In most places existing knex queries may be used to compose sub-queries, etc. Take a look at a few of the examples for each method for instruction on use:</p>
                        <p><strong>Important:</strong> Supplying knex with an <code>undefined</code> value to any of the <code>where</code> functions will cause knex to throw an error during sql compilation. This is both for yours and our sake. Knex cannot know what to do with undefined values in a where clause, and generally it would be a programmatic error to supply one to begin with. The error will throw a message containing the type of query and the compiled query-string. Example:</p>
                    </div><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'accounts'</span>)
.where(<span class="hljs-string">'login'</span>, <span class="hljs-literal">undefined</span>)
.select()
.toSQL();
<span class="hljs-comment">//Undefined binding(s) detected when compiling SELECT query: select * from "accounts" where "login" = ?</span></code></pre>
                    <div id="Builder-where"><b>where</b> — <code>.where(~mixed~)</code></div>
                    <p>Object Syntax:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).where({
first_name: <span class="hljs-string">'Test'</span>,
last_name:  <span class="hljs-string">'User'</span>
}).select(<span class="hljs-string">'id'</span>)</code></pre>
                    <p>Key, Value:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).where(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>)</code></pre>
                    <p>Grouped Chain:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).where(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.where(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>).orWhere(<span class="hljs-string">'id'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">10</span>)
}).orWhere({name: <span class="hljs-string">'Tester'</span>})</code></pre>
                    <p>Operator:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).where(<span class="hljs-string">'votes'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">100</span>)</code></pre><pre class="display"><code class="js hljs"><span class="hljs-keyword">var</span> subquery = knex(<span class="hljs-string">'users'</span>).where(<span class="hljs-string">'votes'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">100</span>).andWhere(<span class="hljs-string">'status'</span>, <span class="hljs-string">'active'</span>).orWhere(<span class="hljs-string">'name'</span>, <span class="hljs-string">'John'</span>).select(<span class="hljs-string">'id'</span>);

knex(<span class="hljs-string">'accounts'</span>).where(<span class="hljs-string">'id'</span>, <span class="hljs-string">'in'</span>, subquery)</code></pre>
                    <p>.orWhere with an object automatically wraps the statement and creates an <code>or (and - and - and)</code> clause</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).where(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>).orWhere({votes: <span class="hljs-number">100</span>, user: <span class="hljs-string">'knex'</span>})</code></pre>
                    <div id="Builder-whereNot"><b>whereNot</b> — <code>.whereNot(~mixed~)</code></div>
                    <p>Object Syntax:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNot({
first_name: <span class="hljs-string">'Test'</span>,
last_name:  <span class="hljs-string">'User'</span>
}).select(<span class="hljs-string">'id'</span>)</code></pre>
                    <p>Key, Value:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNot(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>)</code></pre>
                    <p>Grouped Chain:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNot(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.where(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>).orWhereNot(<span class="hljs-string">'id'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">10</span>)
}).orWhereNot({name: <span class="hljs-string">'Tester'</span>})</code></pre>
                    <p>Operator:</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNot(<span class="hljs-string">'votes'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">100</span>)</code></pre>
                    <p>CAVEAT: WhereNot is not suitable for &quot;in&quot; and &quot;between&quot; type subqueries. You should use &quot;not in&quot; and &quot;not between&quot; instead.</p><pre class="display"><code class="js hljs"><span class="hljs-keyword">var</span> subquery = knex(<span class="hljs-string">'users'</span>)
.whereNot(<span class="hljs-string">'votes'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">100</span>)
.andWhere(<span class="hljs-string">'status'</span>, <span class="hljs-string">'active'</span>)
.orWhere(<span class="hljs-string">'name'</span>, <span class="hljs-string">'John'</span>)
.select(<span class="hljs-string">'id'</span>);

knex(<span class="hljs-string">'accounts'</span>).where(<span class="hljs-string">'id'</span>, <span class="hljs-string">'not in'</span>, subquery)</code></pre>
                    <div id="Builder-whereIn"><b>whereIn</b> — <code>.whereIn(column, array|callback|builder) / .orWhereIn</code>
                        <p>Shorthand for .where(&#x27;id&#x27;, &#x27;in&#x27;, obj), the .whereIn and .orWhereIn methods add a &quot;where in&quot; clause to the query. Click the &quot;play&quot; button below to see the queries.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'name'</span>).from(<span class="hljs-string">'users'</span>)
.whereIn(<span class="hljs-string">'id'</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])
.orWhereIn(<span class="hljs-string">'id'</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'name'</span>).from(<span class="hljs-string">'users'</span>)
.whereIn(<span class="hljs-string">'account_id'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.select(<span class="hljs-string">'id'</span>).from(<span class="hljs-string">'accounts'</span>);
})</code></pre><pre class="display"><code class="js hljs"><span class="hljs-keyword">var</span> subquery = knex.select(<span class="hljs-string">'id'</span>).from(<span class="hljs-string">'accounts'</span>);

knex.select(<span class="hljs-string">'name'</span>).from(<span class="hljs-string">'users'</span>)
.whereIn(<span class="hljs-string">'account_id'</span>, subquery)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.where(<span class="hljs-string">'name'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'John'</span>)
.orWhere(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.where(<span class="hljs-string">'votes'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">100</span>).andWhere(<span class="hljs-string">'title'</span>, <span class="hljs-string">'&lt;&gt;'</span>, <span class="hljs-string">'Admin'</span>);
})</code></pre></div>
                    <div id="Builder-whereNotIn"><b>whereNotIn</b> — <code>.whereNotIn(column, array|callback|builder) / .orWhereNotIn</code><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNotIn(<span class="hljs-string">'id'</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).where(<span class="hljs-string">'name'</span>, <span class="hljs-string">'like'</span>, <span class="hljs-string">'%Test%'</span>).orWhereNotIn(<span class="hljs-string">'id'</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])</code></pre></div>
                    <div id="Builder-whereNull"><b>whereNull</b> — <code>.whereNull(column) / .orWhereNull</code><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNull(<span class="hljs-string">'updated_at'</span>)</code></pre></div>
                    <div id="Builder-whereNotNull"><b>whereNotNull</b> — <code>.whereNotNull(column) / .orWhereNotNull</code><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNotNull(<span class="hljs-string">'created_at'</span>)</code></pre></div>
                    <div id="Builder-whereExists"><b>whereExists</b> — <code>.whereExists(builder | callback) / .orWhereExists</code><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereExists(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'accounts'</span>).whereRaw(<span class="hljs-string">'users.account_id = accounts.id'</span>);
})</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereExists(knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'accounts'</span>).whereRaw(<span class="hljs-string">'users.account_id = accounts.id'</span>))</code></pre></div>
                    <div id="Builder-whereNotExists"><b>whereNotExists</b> — <code>.whereNotExists(builder | callback) / .orWhereNotExists</code><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNotExists(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'accounts'</span>).whereRaw(<span class="hljs-string">'users.account_id = accounts.id'</span>);
})</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNotExists(knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'accounts'</span>).whereRaw(<span class="hljs-string">'users.account_id = accounts.id'</span>))</code></pre></div>
                    <div id="Builder-whereBetween"><b>whereBetween</b> — <code>.whereBetween(column, range) / .orWhereBetween</code><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereBetween(<span class="hljs-string">'votes'</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">100</span>])</code></pre></div>
                    <div id="Builder-whereNotBetween"><b>whereNotBetween</b> — <code>.whereNotBetween(column, range) / .orWhereNotBetween</code><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereNotBetween(<span class="hljs-string">'votes'</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">100</span>])</code></pre></div>
                    <div id="Builder-whereRaw"><b>whereRaw</b> — <code>.whereRaw(query, [bindings])</code>
                        <p>Convenience helper for .where(knex.raw(query)).</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).whereRaw(<span class="hljs-string">'id = ?'</span>, [<span class="hljs-number">1</span>])</code></pre></div>
                    <h3>Join Methods</h3>
                    <p>Several methods are provided which assist in building joins.</p>
                    <div id="Builder-join"><b>join</b> — <code>.join(table, first, [operator], second)</code>
                        <p>The join builder can be used to specify joins between tables, with the first argument being the joining table, the next three arguments being the first join column, the join operator and the second join column, respectively.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.join(<span class="hljs-string">'contacts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'contacts.user_id'</span>)
.select(<span class="hljs-string">'users.id'</span>, <span class="hljs-string">'contacts.phone'</span>)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.join(<span class="hljs-string">'contacts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'contacts.user_id'</span>)
.select(<span class="hljs-string">'users.id'</span>, <span class="hljs-string">'contacts.phone'</span>)</code></pre></div>
                    <p>For grouped joins, specify a function as the second argument for the join query, and use <code>on</code> with <code>orOn</code> or <code>andOn</code> to create joins that are grouped with parentheses.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).join(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre>
                    <p>For nested join statements, specify a function as first argument of <code>on</code>, <code>orOn</code> or <code>andOn</code></p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).join(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>)
  <span class="hljs-keyword">this</span>.orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})
})</code></pre>
                    <p>It is also possible to use an object to represent the join syntax.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).join(<span class="hljs-string">'accounts'</span>, {<span class="hljs-string">'accounts.id'</span>: <span class="hljs-string">'users.account_id'</span>})</code></pre>
                    <p>If you need to use a literal value (string, number, or boolean) in a join instead of a column, use <code>knex.raw</code>.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).join(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'accounts.type'</span>, knex.raw(<span class="hljs-string">'?'</span>, [<span class="hljs-string">'admin'</span>]))</code></pre>
                    <div id="Builder-innerJoin"><b>innerJoin</b> — <code>.innerJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.from(<span class="hljs-string">'users'</span>).innerJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.table(<span class="hljs-string">'users'</span>).innerJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).innerJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-leftJoin"><b>leftJoin</b> — <code>.leftJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).leftJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).leftJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-leftOuterJoin"><b>leftOuterJoin</b> — <code>.leftOuterJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).leftOuterJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).leftOuterJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-rightJoin"><b>rightJoin</b> — <code>.rightJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).rightJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).rightJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-rightOuterJoin"><b>rightOuterJoin</b> — <code>.rightOuterJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).rightOuterJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).rightOuterJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-outerJoin"><b>outerJoin</b> — <code>.outerJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).outerJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).outerJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-fullOuterJoin"><b>fullOuterJoin</b> — <code>.fullOuterJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).fullOuterJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).fullOuterJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-crossJoin"><b>crossJoin</b> — <code>.crossJoin(column, ~mixed~)</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).crossJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-string">'users.id'</span>, <span class="hljs-string">'accounts.user_id'</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).crossJoin(<span class="hljs-string">'accounts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'accounts.id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.account_id'</span>).orOn(<span class="hljs-string">'accounts.owner_id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-string">'users.id'</span>)
})</code></pre></div>
                    <div id="Builder-joinRaw"><b>joinRaw</b> — <code>.joinRaw(sql, [bindings])</code><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'accounts'</span>).joinRaw(<span class="hljs-string">'natural full join table1'</span>).where(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>)</code></pre><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'accounts'</span>).join(knex.raw(<span class="hljs-string">'natural full join table1'</span>)).where(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>)</code></pre></div>
                    <div id="Builder-distinct"><b>distinct</b> — <code>.distinct()</code>
                        <p>Sets a distinct clause on the query.</p><pre class="display"><code class="js hljs"><span class="hljs-comment">// select distinct 'first_name' from customers</span>
knex(<span class="hljs-string">'customers'</span>)
.distinct(<span class="hljs-string">'first_name'</span>, <span class="hljs-string">'last_name'</span>)
.select()</code></pre></div>
                    <div id="Builder-groupBy"><b>groupBy</b> — <code>.groupBy(*names)</code>
                        <p>Adds a group by clause to the query.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).groupBy(<span class="hljs-string">'count'</span>)</code></pre></div>
                    <div id="Builder-groupByRaw"><b>groupByRaw</b> — <code>.groupBy(sql)</code>
                        <p>Adds a raw group by clause to the query.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'year'</span>, knex.raw(<span class="hljs-string">'SUM(profit)'</span>)).from(<span class="hljs-string">'sales'</span>).groupByRaw(<span class="hljs-string">'year WITH ROLLUP'</span>)</code></pre></div>
                    <div id="Builder-orderBy"><b>orderBy</b> — <code>.orderBy(column, [direction])</code>
                        <p>Adds an order by clause to the query.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).orderBy(<span class="hljs-string">'name'</span>, <span class="hljs-string">'desc'</span>)</code></pre></div>
                    <div id="Builder-orderByRaw"><b>orderByRaw</b> — <code>.orderByRaw(sql)</code>
                        <p>Adds an order by raw clause to the query.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'table'</span>).orderByRaw(<span class="hljs-string">'col NULLS LAST DESC'</span>)</code></pre></div>
                    <div id="Builder-having"><b>having</b> — <code>.having(column, operator, value)</code>
                        <p>Adds a having clause to the query.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.groupBy(<span class="hljs-string">'count'</span>)
.orderBy(<span class="hljs-string">'name'</span>, <span class="hljs-string">'desc'</span>)
.having(<span class="hljs-string">'count'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">100</span>)</code></pre></div>
                    <div id="Builder-havingRaw"><b>havingRaw</b> — <code>.havingRaw(column, operator, value)</code>
                        <p>Adds a havingRaw clause to the query.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.groupBy(<span class="hljs-string">'count'</span>)
.orderBy(<span class="hljs-string">'name'</span>, <span class="hljs-string">'desc'</span>)
.havingRaw(<span class="hljs-string">'count &gt; ?'</span>, [<span class="hljs-number">100</span>])</code></pre></div>
                    <div id="Builder-offset"><b>offset</b> — <code>.offset(value)</code>
                        <p>Adds an offset clause to the query.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).offset(<span class="hljs-number">10</span>)</code></pre></div>
                    <div id="Builder-limit"><b>limit</b> — <code>.limit(value)</code>
                        <p>Adds a limit clause to the query.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).limit(<span class="hljs-number">10</span>).offset(<span class="hljs-number">30</span>)</code></pre></div>
                    <div id="Builder-union"><b>union</b> — <code>.union([*queries], [wrap])</code>
                        <p>Creates a union query, taking an array or a list of callbacks to build the union statement, with optional boolean wrap. The queries will be individually wrapped in parentheses with a true wrap parameter.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).whereNull(<span class="hljs-string">'last_name'</span>).union(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).whereNull(<span class="hljs-string">'first_name'</span>);
})</code></pre></div>
                    <div id="Builder-unionAll"><b>unionAll</b> — <code>.unionAll(query)</code>
                        <p>Creates a union all query, with the same method signature as the union method.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).whereNull(<span class="hljs-string">'last_name'</span>).unionAll(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).whereNull(<span class="hljs-string">'first_name'</span>);
})</code></pre></div>
                    <div id="Builder-insert"><b>insert</b> — <code>.insert(data, [returning])</code>
                        <p>Creates an insert query, taking either a hash of properties to be inserted into the row, or an array of inserts, to be executed as a single insert command. Resolves the promise / fulfills the callback with an array containing the first insert id of the inserted model, or an array containing all inserted ids for postgresql.</p><pre class="display"><code class="js hljs"><span class="hljs-comment">// Returns [1] in "mysql", "sqlite", "oracle"; [] in "postgresql" unless the 'returning' parameter is set.</span>
knex(<span class="hljs-string">'books'</span>).insert({title: <span class="hljs-string">'Slaughterhouse Five'</span>})</code></pre><pre class="display"><code class="js hljs"><span class="hljs-comment">// Normalizes for empty keys on multi-row insert:</span>
knex(<span class="hljs-string">'coords'</span>).insert([{x: <span class="hljs-number">20</span>}, {y: <span class="hljs-number">30</span>},  {x: <span class="hljs-number">10</span>, y: <span class="hljs-number">20</span>}])</code></pre><pre class="display"><code class="js hljs"><span class="hljs-comment">// Returns [2] in "mysql", "sqlite"; [2, 3] in "postgresql"</span>
knex.insert([{title: <span class="hljs-string">'Great Gatsby'</span>}, {title: <span class="hljs-string">'Fahrenheit 451'</span>}], <span class="hljs-string">'id'</span>).into(<span class="hljs-string">'books'</span>)</code></pre></div>
                    <p>If one prefers that undefined keys are replaced with <code>NULL</code> instead of <code>DEFAULT</code> one may give <code>useNullAsDefault</code> configuration parameter in knex config.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> knex = <span class="hljs-built_in">require</span>(<span class="hljs-string">'knex'</span>)({
client: <span class="hljs-string">'mysql'</span>,
connection: {
  host : <span class="hljs-string">'127.0.0.1'</span>,
  user : <span class="hljs-string">'your_database_user'</span>,
  password : <span class="hljs-string">'your_database_password'</span>,
  database : <span class="hljs-string">'myapp_test'</span>
},
useNullAsDefault: <span class="hljs-literal">true</span>
});

knex(<span class="hljs-string">'coords'</span>).insert([{x: <span class="hljs-number">20</span>}, {y: <span class="hljs-number">30</span>}, {x: <span class="hljs-number">10</span>, y: <span class="hljs-number">20</span>}])
<span class="hljs-comment">// insert into `coords` (`x`, `y`) values (20, NULL), (NULL, 30), (10, 20)"</span></code></pre>
                    <div id="Builder-returning"><b>returning</b> — <code>.returning(column) / .returning([column1, column2, ...])</code>
                        <p>Utilized by PostgreSQL, MSSQL, and Oracle databases, the returning method specifies which column should be returned by the insert and update methods. Passed column parameter may be a string or an array of strings. When passed in a string, makes the SQL result be reported as an array of values from the specified column. When passed in an array of strings, makes the SQL result be reported as an array of objects, each containing a single property for each of the specified columns.</p><pre class="display"><code class="js hljs"><span class="hljs-comment">// Returns [1]</span>
knex(<span class="hljs-string">'books'</span>)
.returning(<span class="hljs-string">'id'</span>)
.insert({title: <span class="hljs-string">'Slaughterhouse Five'</span>})</code></pre><pre class="display"><code class="js hljs"><span class="hljs-comment">// Returns [2] in "mysql", "sqlite"; [2, 3] in "postgresql"</span>
knex(<span class="hljs-string">'books'</span>)
.returning(<span class="hljs-string">'id'</span>)
.insert([{title: <span class="hljs-string">'Great Gatsby'</span>}, {title: <span class="hljs-string">'Fahrenheit 451'</span>}])</code></pre><pre class="display"><code class="js hljs"><span class="hljs-comment">// Returns [ { id: 1, title: 'Slaughterhouse Five' } ]</span>
knex(<span class="hljs-string">'books'</span>)
.returning([<span class="hljs-string">'id'</span>,<span class="hljs-string">'title'</span>])
.insert({title: <span class="hljs-string">'Slaughterhouse Five'</span>})</code></pre></div>
                    <div id="Builder-update"><b>update</b> — <code>.update(data, [returning]) / .update(key, value, [returning])</code>
                        <p>Creates an update query, taking a hash of properties or a key/value pair to be updated based on the other query constraints. Resolves the promise / fulfills the callback with the number of affected rows for the query. If a key to be updated has value undefined it is ignored.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'books'</span>)
.where(<span class="hljs-string">'published_date'</span>, <span class="hljs-string">'&lt;'</span>, <span class="hljs-number">2000</span>)
.update({
status: <span class="hljs-string">'archived'</span>,
thisKeyIsSkipped: <span class="hljs-literal">undefined</span>
})</code></pre><pre class="display"><code class="js hljs"><span class="hljs-comment">// Returns [1] in "mysql", "sqlite", "oracle"; [] in "postgresql" unless the 'returning' parameter is set.</span>
knex(<span class="hljs-string">'books'</span>).update(<span class="hljs-string">'title'</span>, <span class="hljs-string">'Slaughterhouse Five'</span>)</code></pre></div>
                    <div id="Builder-del / delete"><b>del / delete</b> — <code>.del()</code>
                        <p>Aliased to del as delete is a reserved word in javascript, this method deletes one or more rows, based on other conditions specified in the query. Resolves the promise / fulfills the callback with the number of affected rows for the query.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'accounts'</span>)
.where(<span class="hljs-string">'activated'</span>, <span class="hljs-literal">false</span>)
.del()</code></pre></div>
                    <div id="Builder-transacting"><b>transacting</b> — <code>.transacting(transactionObj)</code>
                        <p>Used by knex.transaction, the transacting method may be chained to any query and passed the object you wish to join the query as part of the transaction for.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-built_in">Promise</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bluebird'</span>);
knex.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">trx</span>) </span>{
knex(<span class="hljs-string">'books'</span>).transacting(trx).insert({name: <span class="hljs-string">'Old Books'</span>})
  .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resp</span>) </span>{
    <span class="hljs-keyword">var</span> id = resp[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">return</span> someExternalMethod(id, trx);
  })
  .then(trx.commit)
  .catch(trx.rollback);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resp</span>) </span>{
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Transaction complete.'</span>);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
<span class="hljs-built_in">console</span>.error(err);
});</code></pre></div>
                    <div id="Builder-forUpdate"><b>forUpdate</b> — <code>.transacting(t).forUpdate()</code>
                        <p>Dynamically added after a transaction is specified, the forUpdate adds a FOR UPDATE in PostgreSQL and MySQL during a select statement.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'tableName'</span>)
.transacting(trx)
.forUpdate()
.select(<span class="hljs-string">'*'</span>)</code></pre></div>
                    <div id="Builder-forShare"><b>forShare</b> — <code>.transacting(t).forShare()</code>
                        <p>Dynamically added after a transaction is specified, the forShare adds a FOR SHARE in PostgreSQL and a LOCK IN SHARE MODE for MySQL during a select statement.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'tableName'</span>)
.transacting(trx)
.forShare()
.select(<span class="hljs-string">'*'</span>)</code></pre></div>
                    <div id="Builder-count"><b>count</b> — <code>.count(column)</code>
                        <p>Performs a count on the specified column. Note that in Postgres, count returns a bigint type which will be a String and not a Number (more info).</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).count(<span class="hljs-string">'active'</span>)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).count(<span class="hljs-string">'active as a'</span>)</code></pre></div>
                    <p>Use <strong>countDistinct</strong> to add a distinct expression inside the aggregate function.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).countDistinct(<span class="hljs-string">'active'</span>)</code></pre>
                    <div id="Builder-min"><b>min</b> — <code>.min(column)</code>
                        <p>Gets the minimum value for the specified column.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).min(<span class="hljs-string">'age'</span>)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).min(<span class="hljs-string">'age as a'</span>)</code></pre></div>
                    <div id="Builder-max"><b>max</b> — <code>.max(column)</code>
                        <p>Gets the maximum value for the specified column.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).max(<span class="hljs-string">'age'</span>)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).max(<span class="hljs-string">'age as a'</span>)</code></pre></div>
                    <div id="Builder-sum"><b>sum</b> — <code>.sum(column)</code>
                        <p>Retrieve the sum of the values of a given column.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).sum(<span class="hljs-string">'products'</span>)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).sum(<span class="hljs-string">'products as p'</span>)</code></pre></div>
                    <p>Use <strong>sumDistinct</strong> to add a distinct expression inside the aggregate function.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).sumDistinct(<span class="hljs-string">'products'</span>)</code></pre>
                    <div id="Builder-avg"><b>avg</b> — <code>.avg(column)</code>
                        <p>Retrieve the average of the values of a given column.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).avg(<span class="hljs-string">'age'</span>)</code></pre><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).avg(<span class="hljs-string">'age as a'</span>)</code></pre></div>
                    <p>Use <strong>avgDistinct</strong> to add a distinct expression inside the aggregate function.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).avgDistinct(<span class="hljs-string">'age'</span>)</code></pre>
                    <div id="Builder-increment"><b>increment</b> — <code>.increment(column, amount)</code>
                        <p>Increments a column value by the specified amount.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'accounts'</span>)
.where(<span class="hljs-string">'userid'</span>, <span class="hljs-string">'='</span>, <span class="hljs-number">1</span>)
.increment(<span class="hljs-string">'balance'</span>, <span class="hljs-number">10</span>)</code></pre></div>
                    <div id="Builder-decrement"><b>decrement</b> — <code>.decrement(column, amount)</code>
                        <p>Decrements a column value by the specified amount.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'accounts'</span>).where(<span class="hljs-string">'userid'</span>, <span class="hljs-string">'='</span>, <span class="hljs-number">1</span>).decrement(<span class="hljs-string">'balance'</span>, <span class="hljs-number">5</span>)</code></pre></div>
                    <div id="Builder-truncate"><b>truncate</b> — <code>.truncate()</code>
                        <p>Truncates the current table.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'accounts'</span>).truncate()</code></pre></div>
                    <div id="Builder-pluck"><b>pluck</b> — <code>.pluck(id)</code>
                        <p>This will pluck the specified column from each row in your results, yielding a promise which resolves to the array of values selected.</p><pre><code class="hljs js">knex.table(<span class="hljs-string">'users'</span>).pluck(<span class="hljs-string">'id'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ids</span>) </span>{ <span class="hljs-built_in">console</span>.log(ids); });</code></pre></div>
                    <div id="Builder-first"><b>first</b> — <code>.first([columns])</code>
                        <p>Similar to select, but only retrieves &amp; resolves with the first record from the query.</p><pre><code class="hljs js">knex.table(<span class="hljs-string">'users'</span>).first(<span class="hljs-string">'id'</span>, <span class="hljs-string">'name'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">row</span>) </span>{ <span class="hljs-built_in">console</span>.log(row); });</code></pre></div>
                    <div id="Builder-clone"><b>clone</b> — <code>.clone()</code>
                        <p>Clones the current query chain, useful for re-using partial query snippets in other queries without mutating the original.</p>
                    </div>
                    <div id="Builder-modify"><b>modify</b> — <code>.modify(fn, *arguments)</code>
                        <p>Allows encapsulating and re-using query snippets and common behaviors as functions. The callback function should receive the query builder as its first argument, followed by the rest of the (optional) parameters passed to modify. `var withUserName = function(queryBuilder, foreignKey) { queryBuilder .leftJoin(&#x27;users&#x27;, foreignKey, &#x27;users.id&#x27;) .select(&#x27;users.user_name&#x27;); }; knex .table(&#x27;articles&#x27;) .select(&#x27;title&#x27;, &#x27;body&#x27;) .modify(withUserName, &#x27;articles_user.id&#x27;) .then(function(article) { console.log(article.user_name); });`</p>
                    </div>
                    <div id="Builder-columnInfo"><b>columnInfo</b> — <code>.columnInfo([columnName])</code>
                        <p>Returns an object with the column info about the current table, or an individual column if one is passed, returning an object with the following keys:* **defaultValue**: the default value for the column* **type**: the column type* **maxLength**: the max length set for the column* **nullable**: whether the column may be null</p><pre><code class="hljs js">knex(<span class="hljs-string">'users'</span>).columnInfo().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">info</span>) </span>{ <span class="hljs-comment">// ... });</span></code></pre></div>
                    <div id="Builder-debug"><b>debug</b> — <code>.debug([enabled])</code>
                        <p>Overrides the global debug setting for the current query chain. If enabled is omitted, query debugging will be turned on.</p>
                    </div>
                    <div id="Builder-connection"><b>connection</b> — <code>.connection(dbConnection)</code>
                        <p>Explicitly specify the connection for the query, allowing you to use the knex chain outside of the built-in pooling capabilities.</p>
                    </div>
                    <div id="Builder-options"><b>options</b> — <code>.options()</code>
                        <p>Allows for mixing in additional options as defined by database client specific libraries:</p><pre><code class="hljs js">knex(<span class="hljs-string">'accounts as a1'</span>)
.leftJoin(<span class="hljs-string">'accounts as a2'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">this</span>.on(<span class="hljs-string">'a1.email'</span>, <span class="hljs-string">'&lt;&gt;'</span>, <span class="hljs-string">'a2.email'</span>);
})
.select([<span class="hljs-string">'a1.email'</span>, <span class="hljs-string">'a2.email'</span>])
.where(knex.raw(<span class="hljs-string">'a1.id = 1'</span>))
.option({ nestTables: <span class="hljs-literal">true</span>, rowMode: <span class="hljs-string">'array'</span> })
.limit(<span class="hljs-number">2</span>)
.then(...</code></pre></div>
                </div>
                <div id="Transactions">
                    <h2 id="Transactions">Transactions</h2>
                    <div>
                        <p>Transactions are an important feature of relational databases, as they allow correct recovery from failures and keep a database consistent even in cases of system failure. All queries within a transaction are executed on the same database connection, and run the entire set of queries as a single unit of work. Any failure will mean the database will rollback any queries executed on that connection to the pre-transaction state.</p>
                        <p>Transactions are handled by passing a handler function into <code>knex.transaction</code>. The handler function accepts a single argument, an object which may be used in two ways:
                            <ol>
                                <li>As the &quot;promise aware&quot; knex connection</li>
                                <li>As an object passed into a query with
                                    <a href="#Builder-transacting"></a>and eventually call commit or rollback.</li>
                            </ol>
                            Consider these two examples:</p>
                    </div><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-built_in">Promise</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bluebird'</span>);

<span class="hljs-comment">// Using trx as a query builder:</span>
knex.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">trx</span>) </span>{

<span class="hljs-keyword">var</span> books = [
  {title: <span class="hljs-string">'Canterbury Tales'</span>},
  {title: <span class="hljs-string">'Moby Dick'</span>},
  {title: <span class="hljs-string">'Hamlet'</span>}
];

<span class="hljs-keyword">return</span> trx
  .insert({name: <span class="hljs-string">'Old Books'</span>}, <span class="hljs-string">'id'</span>)
  .into(<span class="hljs-string">'catalogues'</span>)
  .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ids</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.map(books, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">book</span>) </span>{
      book.catalogue_id = ids[<span class="hljs-number">0</span>];

      <span class="hljs-comment">// Some validation could take place here.</span>

      <span class="hljs-keyword">return</span> trx.insert(info).into(<span class="hljs-string">'books'</span>);
    });
  });
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">inserts</span>) </span>{
<span class="hljs-built_in">console</span>.log(inserts.length + <span class="hljs-string">' new books saved.'</span>);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
<span class="hljs-comment">// If we get here, that means that neither the 'Old Books' catalogues insert,</span>
<span class="hljs-comment">// nor any of the books inserts will have taken place.</span>
<span class="hljs-built_in">console</span>.error(error);
});</code></pre>
                    <p>And then this example:</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-built_in">Promise</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bluebird'</span>);

<span class="hljs-comment">// Using trx as a transaction object:</span>
knex.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">trx</span>) </span>{

<span class="hljs-keyword">var</span> books = [
  {title: <span class="hljs-string">'Canterbury Tales'</span>},
  {title: <span class="hljs-string">'Moby Dick'</span>},
  {title: <span class="hljs-string">'Hamlet'</span>}
];

knex.insert({name: <span class="hljs-string">'Old Books'</span>}, <span class="hljs-string">'id'</span>)
  .into(<span class="hljs-string">'catalogues'</span>)
  .transacting(trx)
  .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ids</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.map(books, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">book</span>) </span>{
      book.catalogue_id = ids[<span class="hljs-number">0</span>];

      <span class="hljs-comment">// Some validation could take place here.</span>

      <span class="hljs-keyword">return</span> knex.insert(info).into(<span class="hljs-string">'books'</span>).transacting(trx);
    });
  })
  .then(trx.commit)
  .catch(trx.rollback);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">inserts</span>) </span>{
<span class="hljs-built_in">console</span>.log(inserts.length + <span class="hljs-string">' new books saved.'</span>);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
<span class="hljs-comment">// If we get here, that means that neither the 'Old Books' catalogues insert,</span>
<span class="hljs-comment">// nor any of the books inserts will have taken place.</span>
<span class="hljs-built_in">console</span>.error(error);
});</code></pre>
                    <div>
                        <p>Throwing an error directly from the transaction handler function automatically rolls back the transaction, same as returning a rejected promise.</p>
                        <p>Notice that if a promise is not returned within the handler, it is up to you to ensure <code>trx.commit</code>, or <code>trx.rollback</code> are called, otherwise the transaction connection will hang.</p>
                    </div>
                </div>
                <div id="Schema">
                    <h2 id="Schema">Schema Builder</h2>
                    <p>These methods return <a href="http://knexjs.org/#Interfaces-Promises">promises</a>.</p>
                    <div id="Schema-withSchema"><b>withSchema</b> — <code>knex.schema.withSchema([schemaName])</code>
                        <p>Specifies the schema to be used when using the schema-building commands.</p><pre class="display"><code class="js hljs">knex.schema.withSchema(<span class="hljs-string">'public'</span>).createTable(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">table</span>) </span>{
table.increments();
})</code></pre></div>
                    <div id="Schema-createTable"><b>createTable</b> — <code>knex.schema.createTable(tableName, callback)</code>
                        <p>Creates a new table on the database, with a callback function to modify the table&#x27;s structure, using the schema-building commands.</p><pre class="display"><code class="js hljs">knex.schema.createTable(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">table</span>) </span>{
table.increments();
table.string(<span class="hljs-string">'name'</span>);
table.timestamps();
})</code></pre></div>
                    <div id="Schema-createTableIfNotExists"><b>createTableIfNotExists</b> — <code>knex.schema.createTableIfNotExists(tableName, callback)</code>
                        <p>Creates a new table on the database if it doesn&#x27;t exists on database, with a callback function to modify the table&#x27;s structure, using the schema-building commands.</p><pre class="display"><code class="js hljs">knex.schema.createTableIfNotExists(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">table</span>) </span>{
table.increments();
table.string(<span class="hljs-string">'name'</span>);
table.timestamps();
})</code></pre></div>
                    <div id="Schema-renameTable"><b>renameTable</b> — <code>knex.schema.renameTable(from, to)</code>
                        <p>Renames a table from a current tableName to another.</p><pre class="display"><code class="js hljs">knex.schema.renameTable(<span class="hljs-string">'users'</span>, <span class="hljs-string">'old_users'</span>)</code></pre></div>
                    <div id="Schema-dropTable"><b>dropTable</b> — <code>knex.schema.dropTable(tableName)</code>
                        <p>Drops a table, specified by tableName.</p><pre class="display"><code class="js hljs">knex.schema.dropTable(<span class="hljs-string">'users'</span>)</code></pre></div>
                    <div id="Schema-hasTable"><b>hasTable</b> — <code>knex.schema.hasTable(tableName)</code>
                        <p>Checks for a table&#x27;s existence by tableName, resolving with a boolean to signal if the table exists.</p><pre><code class="hljs js">knex.schema.hasTable(<span class="hljs-string">'users'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exists</span>) </span>{
<span class="hljs-keyword">if</span> (!exists) {
  <span class="hljs-keyword">return</span> knex.schema.createTable(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) </span>{
    t.increments(<span class="hljs-string">'id'</span>).primary();
    t.string(<span class="hljs-string">'first_name'</span>, <span class="hljs-number">100</span>);
    t.string(<span class="hljs-string">'last_name'</span>, <span class="hljs-number">100</span>);
    t.text(<span class="hljs-string">'bio'</span>);
  });
}
});</code></pre></div>
                    <div id="Schema-hasColumn"><b>hasColumn</b> — <code>knex.schema.hasColumn(tableName, columnName)</code>
                        <p>Checks if a column exists in the current table, resolves the promise with a boolean, true if the column exists, false otherwise.</p>
                    </div>
                    <div id="Schema-dropTableIfExists"><b>dropTableIfExists</b> — <code>knex.schema.dropTableIfExists(tableName)</code>
                        <p>Drops a table conditionally if the table exists, specified by tableName.</p><pre class="display"><code class="js hljs">knex.schema.dropTableIfExists(<span class="hljs-string">'users'</span>)</code></pre></div>
                    <div id="Schema-table"><b>table</b> — <code>knex.schema.table(tableName, callback)</code>
                        <p>Chooses a database table, and then modifies the table, using the Schema Building functions inside of the callback.</p><pre class="display"><code class="js hljs">knex.schema.table(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">table</span>) </span>{
table.dropColumn(<span class="hljs-string">'name'</span>);
table.string(<span class="hljs-string">'first_name'</span>);
table.string(<span class="hljs-string">'last_name'</span>);
})</code></pre></div>
                    <div id="Schema-raw"><b>raw</b> — <code>knex.schema.raw(statement)</code>
                        <p>Run an arbitrary sql query in the schema builder chain.</p><pre class="display"><code class="js hljs">knex.schema.raw(<span class="hljs-string">"SET sql_mode='TRADITIONAL'"</span>)
.table(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">table</span>) </span>{
table.dropColumn(<span class="hljs-string">'name'</span>);
table.string(<span class="hljs-string">'first_name'</span>);
table.string(<span class="hljs-string">'last_name'</span>);
})</code></pre></div>
                    <h3 id="Schema-Building">Schema Building:</h3>
                    <div id="Schema-dropColumn"><b>dropColumn</b> — <code>table.dropColumn(name)</code>
                        <p>Drops a column, specified by the column&#x27;s name</p>
                    </div>
                    <div id="Schema-dropColumns"><b>dropColumns</b> — <code>table.dropColumns(*columns)</code>
                        <p>Drops multiple columns, taking a variable number of column names.</p>
                    </div>
                    <div id="Schema-renameColumn"><b>renameColumn</b> — <code>table.renameColumn(from, to)</code>
                        <p>Renames a column from one name to another.</p>
                    </div>
                    <div id="Schema-increments"><b>increments</b> — <code>table.increments(name)</code>
                        <p>Adds an auto incrementing column, in PostgreSQL this is a serial. This will be used as the primary key for the column. Also available is a bigIncrements if you wish to add a bigint incrementing number (in PostgreSQL bigserial).</p>
                    </div>
                    <div id="Schema-integer"><b>integer</b> — <code>table.integer(name)</code>
                        <p>Adds an integer column.</p>
                    </div>
                    <div id="Schema-bigInteger"><b>bigInteger</b> — <code>table.bigInteger(name)</code>
                        <p>In MySQL or PostgreSQL, adds a bigint column, otherwise adds a normal integer. Note that bigint data is returned as a string in queries because JavaScript may be unable to parse them without loss of precision.</p>
                    </div>
                    <div id="Schema-text"><b>text</b> — <code>table.text(name, [textType])</code>
                        <p>Adds a text column, with optional textType for MySql text datatype preference. textType may be mediumtext or longtext, otherwise defaults to text.</p>
                    </div>
                    <div id="Schema-string"><b>string</b> — <code>table.string(name, [length])</code>
                        <p>Adds a string column, with optional length defaulting to 255.</p>
                    </div>
                    <div id="Schema-float"><b>float</b> — <code>table.float(column, [precision], [scale])</code>
                        <p>Adds a float column, with optional precision (defaults to 8) and scale (defaults to 2).</p>
                    </div>
                    <div id="Schema-decimal"><b>decimal</b> — <code>table.decimal(column, [precision], [scale])</code>
                        <p>Adds a decimal column, with optional precision (defaults to 8) and scale (defaults to 2).</p>
                    </div>
                    <div id="Schema-boolean"><b>boolean</b> — <code>table.boolean(name)</code>
                        <p>Adds a boolean column.</p>
                    </div>
                    <div id="Schema-date"><b>date</b> — <code>table.date(name)</code>
                        <p>Adds a date column.</p>
                    </div>
                    <div id="Schema-dateTime"><b>dateTime</b> — <code>table.dateTime(name)</code>
                        <p>Adds a dateTime column.</p>
                    </div>
                    <div id="Schema-time"><b>time</b> — <code>table.time(name)</code>
                        <p>Adds a time column.</p>
                    </div>
                    <div id="Schema-timestamp"><b>timestamp</b> — <code>table.timestamp(name, [standard])</code>
                        <p>Adds a timestamp column, defaults to timestamptz in PostgreSQL, unless true is passed as the second argument. For Example: table.timestamp(&#x27;created_at&#x27;).defaultTo(knex.fn.now());</p>
                    </div>
                    <div id="Schema-timestamps"><b>timestamps</b> — <code>table.timestamps()</code>
                        <p>Adds a created_at and updated_at column on the database, setting these each to dateTime types. When true is passed as the first argument a timestamp type is used. Both colums default to being not null and the current timestamp when true is passed as the second argument.</p>
                    </div>
                    <div id="Schema-dropTimestamps"><b>dropTimestamps</b> — <code>table.dropTimestamps()</code>
                        <p>Drops the columns created_at and updated_at from the table, which can be created via timestamps.</p>
                    </div>
                    <div id="Schema-binary"><b>binary</b> — <code>table.binary(name, [length])</code>
                        <p>Adds a binary column, with optional length argument for MySQL.</p>
                    </div>
                    <div id="Schema-enum / enu"><b>enum / enu</b> — <code>table.enu(col, values)</code>
                        <p>Adds a enum column, (aliased to enu, as enum is a reserved word in javascript). Note that the second argument is an array of values. Example: table.enu(&#x27;column&#x27;, [&#x27;value1&#x27;, &#x27;value2&#x27;])</p>
                    </div>
                    <div id="Schema-json"><b>json</b> — <code>table.json(name)</code>
                        <p>Adds a json column, using the built-in json type in postgresql, defaulting to a text column in older versions of postgresql or in unsupported databases. Note that when setting an array (or a value that could be an array) as the value of a json or jsonb column, you should use JSON.stringify() to convert your value to a string prior to passing it to the query builder, e.g. knex.table(&#x27;users&#x27;) .where({id: 1}) .update({json_data: JSON.stringify(mightBeAnArray)}); This is because postgresql has a native array type which uses a syntax incompatible with json; knex has no way of knowing which syntax to use, and calling JSON.stringify() forces json-style syntax.</p>
                    </div>
                    <div id="Schema-jsonb"><b>jsonb</b> — <code>table.jsonb(name)</code>
                        <p>Adds a jsonb column. Works similar to table.json(), but uses native jsonb type if possible.</p>
                    </div>
                    <div id="Schema-uuid"><b>uuid</b> — <code>table.uuid(name)</code>
                        <p>Adds a uuid column - this uses the built-in uuid type in postgresql, and falling back to a char(36) in other databases.</p>
                    </div>
                    <div id="Schema-comment"><b>comment</b> — <code>table.comment(value)</code>
                        <p>Sets the comment for a table.</p>
                    </div>
                    <div id="Schema-engine"><b>engine</b> — <code>table.engine(val)</code>
                        <p>Sets the engine for the database table, only available within a createTable call, and only applicable to MySQL.</p>
                    </div>
                    <div id="Schema-charset"><b>charset</b> — <code>table.charset(val)</code>
                        <p>Sets the charset for the database table, only available within a createTable call, and only applicable to MySQL.</p>
                    </div>
                    <div id="Schema-collate"><b>collate</b> — <code>table.collate(val)</code>
                        <p>Sets the collation for the database table, only available within a createTable call, and only applicable to MySQL.</p>
                    </div>
                    <div id="Schema-inherits"><b>inherits</b> — <code>table.inherits(val)</code>
                        <p>Sets the tables that this table inherits, only available within a createTable call, and only applicable to PostgreSQL.</p>
                    </div>
                    <div id="Schema-specificType"><b>specificType</b> — <code>table.specificType(column, value)</code>
                        <p>Sets a specific type for the column creation, if you&#x27;d like to add a column type that isn&#x27;t supported here.</p>
                    </div>
                    <div id="Schema-index"><b>index</b> — <code>table.index(columns, [indexName], [indexType])</code>
                        <p>Adds an index to a table over the given columns. A default index name using the columns is used unless indexName is specified. The indexType can be optionally specified for PostgreSQL.</p>
                    </div>
                    <div id="Schema-dropIndex"><b>dropIndex</b> — <code>table.dropIndex(columns, [indexName])</code>
                        <p>Drops an index from a table. A default index name using the columns is used unless indexName is specified (in which case columns is ignored).</p>
                    </div>
                    <div id="Schema-foreign"><b>foreign</b> — <code>table.foreign(columns)</code>
                        <p>Adds a foreign key constraint to a table for an existing column using table.foreign(column).references(column) or multiple columns using table.foreign(columns).references(columns). You can also chain onDelete and/or onUpdate to set the reference option (RESTRICT, CASCADE, SET NULL, NO ACTION) for the operation. Note, this is the same as column.references(column) but works for existing columns.</p>
                    </div>
                    <div id="Schema-dropForeign"><b>dropForeign</b> — <code>table.dropForeign(columns, [foreignKeyName])</code>
                        <p>Drops a foreign key constraint from a table. A default foreign key name using the columns is used unless foreignKeyName is specified (in which case columns is ignored).</p>
                    </div>
                    <div id="Schema-dropUnique"><b>dropUnique</b> — <code>table.dropUnique(columns, [indexName])</code>
                        <p>Drops a unique key constraint from a table. A default unique key name using the columns is used unless indexName is specified (in which case columns is ignored).</p>
                    </div>
                    <div id="Schema-dropPrimary"><b>dropPrimary</b> — <code>table.dropPrimary([constraintName])</code>
                        <p>Drops the primary key constraint on a table. Defaults to tablename_pkey unless constraintName is specified.</p>
                    </div>
                    <h3 id="Chainable">Chainable Methods:</h3>
                    <p>The following three methods may be chained on the schema building methods, as modifiers to the column.</p>
                    <div id="Schema-index"><b>index</b> — <code>column.index([indexName], [indexType])</code>
                        <p>Specifies a field as an index. If an indexName is specified, it is used in place of the standard index naming convention of tableName_columnName. The indexType can be optionally specified for PostgreSQL. No-op if this is chained off of a field that cannot be indexed.</p>
                    </div>
                    <div id="Schema-primary"><b>primary</b> — <code>column.primary([constraintName])</code>
                        <p>When called on a single column it will set that column as the primary key for a table. To create a compound primary key, pass an array of column names: table.primary([&#x27;column1&#x27;, &#x27;column2&#x27;]) Constraint name defaults to `tablename_pkey` unless `constraintName` is specified.</p>
                    </div>
                    <div id="Schema-unique"><b>unique</b> — <code>column.unique()</code>
                        <p>Sets the column as unique.</p>
                    </div>
                    <div id="Schema-references"><b>references</b> — <code>column.references(column)</code>
                        <p>Sets the &quot;column&quot; that the current column references as a foreign key. &quot;column&quot; can either be &quot;.&lt;column&gt;&quot; syntax, or just the column name followed up with a call to inTable to specify the table.&lt;/column&gt; &lt;table&gt;&lt;/table&gt;
                        </p>
                    </div>
                    <div id="Schema-inTable"><b>inTable</b> — <code>column.inTable(table)</code>
                        <p>Sets the &quot;table&quot; where the foreign key column is located after calling column.references.</p>
                    </div>
                    <div id="Schema-onDelete"><b>onDelete</b> — <code>column.onDelete(command)</code>
                        <p>Sets the SQL command to be run &quot;onDelete&quot;.</p>
                    </div>
                    <div id="Schema-onUpdate"><b>onUpdate</b> — <code>column.onUpdate(command)</code>
                        <p>Sets the SQL command to be run &quot;onUpdate&quot;.</p>
                    </div>
                    <div id="Schema-defaultTo"><b>defaultTo</b> — <code>column.defaultTo(value)</code>
                        <p>Sets the default value for the column on an insert.</p>
                    </div>
                    <div id="Schema-unsigned"><b>unsigned</b> — <code>column.unsigned()</code>
                        <p>Specifies an integer as unsigned. No-op if this is chained off of a non-integer field.</p>
                    </div>
                    <div id="Schema-notNullable"><b>notNullable</b> — <code>column.notNullable()</code>
                        <p>Adds a not null on the current column being created.</p>
                    </div>
                    <div id="Schema-nullable"><b>nullable</b> — <code>column.nullable()</code>
                        <p>Default on column creation, this explicitly sets a field to be nullable.</p>
                    </div>
                    <div id="Schema-first"><b>first</b> — <code>column.first()</code>
                        <p>Sets the column to be inserted on the first position, only used in MySQL alter tables.</p>
                    </div>
                    <div id="Schema-after"><b>after</b> — <code>column.after(field)</code>
                        <p>Sets the column to be inserted after another, only used in MySQL alter tables.</p>
                    </div>
                    <div id="Schema-comment"><b>comment</b> — <code>column.comment(value)</code>
                        <p>Sets the comment for a column.</p>
                    </div><pre><code>knex.schema.createTable('accounts', function(t) {
t.increments().primary();
t.string('email').unique().comment('This is the email field');
});</code></pre>
                    <div id="Schema-collate"><b>collate</b> — <code>column.collate(collation)</code>
                        <p>Sets the collation for a column (only works in MySQL). Here is a list of all available collations: https://dev.mysql.com/doc/refman/5.5/en/charset-charsets.html</p>
                    </div><pre><code>knex.schema.createTable('users', function(t) {
t.increments();
t.string('email').unique().collate('utf8_unicode_ci');
});</code></pre></div>
                <div id="Raw">
                    <h2 id="Raw">Raw</h2>
                    <p>Sometimes you may need to use a raw expression in a query. Raw query object may be injected pretty much anywhere you want, and using proper bindings can ensure your values are escaped properly, preventing SQL-injection attacks.</p>
                    <h3 id="Raw-Bindings">Raw Parameter Binding:</h3>
                    <p>One can paramterize sql given to <code>knex.raw(sql, bindings)</code>. Parameters can be positional named. One can also choose if parameter should be treated as value or as sql identifier e.g. in case of <code>&#39;TableName.ColumnName&#39;</code> reference.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.select(knex.raw(<span class="hljs-string">'count(*) as user_count, status'</span>))
.where(knex.raw(<span class="hljs-number">1</span>))
.orWhere(knex.raw(<span class="hljs-string">'status &lt;&gt; ?'</span>, [<span class="hljs-number">1</span>]))
.groupBy(<span class="hljs-string">'status'</span>)</code></pre>
                    <p>Positional bindings <code>?</code> are interpreted as values and <code>??</code> are interpreted as identifiers.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>).where(knex.raw(<span class="hljs-string">'?? = ?'</span>, [<span class="hljs-string">'user.name'</span>, <span class="hljs-number">1</span>]))</code></pre>
                    <p>Named bindings such as <code>:name</code> are interpreted as values and <code>:name:</code> interpreted as identifiers. Named bindings are processed so long as the value is anything other than <code>undefined</code>.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.where(knex.raw(<span class="hljs-string">':name: = :thisGuy or :name: = :otherGuy or :name: = :undefinedBinding'</span>, {
name: <span class="hljs-string">'users.name'</span>,
thisGuy: <span class="hljs-string">'Bob'</span>,
otherGuy: <span class="hljs-string">'Jay'</span>,
undefinedBinding: <span class="hljs-literal">undefined</span>
}))</code></pre>
                    <p>For simpler queries where one only has a single binding, <code>.raw</code> can accept said binding as its second parameter.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.where(
knex.raw(<span class="hljs-string">'LOWER("login") = ?'</span>, <span class="hljs-string">'knex'</span>)
)
.orWhere(
knex.raw(<span class="hljs-string">'accesslevel = ?'</span>, <span class="hljs-number">1</span>)
)
.orWhere(
knex.raw(<span class="hljs-string">'updtime = ?'</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>())
)</code></pre>
                    <p>Note that due to ambiguity, arrays must be passed as arguments within a containing array.</p><pre class="display"><code class="js hljs">knex.raw(<span class="hljs-string">'select * from users where id in (?)'</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
<span class="hljs-comment">// Error: Expected 3 bindings, saw 1</span>

knex.raw(<span class="hljs-string">'select * from users where id in (?)'</span>, [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]])</code></pre>
                    <p>To prevent replacement of <code>?</code> one can use the escape sequence <code>\\?</code>.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).where(<span class="hljs-string">'id'</span>, <span class="hljs-string">'='</span>, <span class="hljs-number">1</span>).whereRaw(<span class="hljs-string">'?? \\? ?'</span>, [<span class="hljs-string">'jsonColumn'</span>, <span class="hljs-string">'jsonKey'</span>])</code></pre>
                    <p>To prevent replacement of named bindings one can use the escape sequence <code>\\:</code>.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).whereRaw(<span class="hljs-string">":property: = '\\:value' OR \\:property: = :value"</span>, {
property: <span class="hljs-string">'name'</span>,
value: <span class="hljs-string">'Bob'</span>
})</code></pre>
                    <h3 id="Raw-Expressions">Raw Expressions:</h3>
                    <p>Raw expressions are created by using <code>knex.raw(sql, [bindings])</code> and passing this as a value for any value in the query chain.</p><pre class="display"><code class="js hljs">knex(<span class="hljs-string">'users'</span>)
.select(knex.raw(<span class="hljs-string">'count(*) as user_count, status'</span>))
.where(knex.raw(<span class="hljs-number">1</span>))
.orWhere(knex.raw(<span class="hljs-string">'status &lt;&gt; ?'</span>, [<span class="hljs-number">1</span>]))
.groupBy(<span class="hljs-string">'status'</span>)</code></pre>
                    <h3 id="Raw-Queries">Raw Queries:</h3>
                    <p>The <code>knex.raw</code> may also be used to build a full query and execute it, as a standard query builder query would be executed. The benefit of this is that it uses the connection pool and provides a standard interface for the different client libraries.</p><pre><code class="hljs js">knex.raw(<span class="hljs-string">'select * from users where id = ?'</span>, [<span class="hljs-number">1</span>]).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resp</span>) </span>{ ... });</code></pre>
                    <p class="info">Note that the response will be whatever the underlying sql library would typically return on a normal query, so you may need to look at the documentation for the base library the queries are executing against to determine how to handle the response.</p>
                    <h3 id="Raw-queries-wrapped">Wrapped Queries:</h3>
                    <p>The raw query builder also comes with a <code>wrap</code> method, which allows wrapping the query in a value:</p><pre class="display"><code class="js hljs"><span class="hljs-keyword">var</span> subcolumn = knex.raw(<span class="hljs-string">'select avg(salary) from employee where dept_no = e.dept_no'</span>)
.wrap(<span class="hljs-string">'('</span>, <span class="hljs-string">') avg_sal_dept'</span>);

knex.select(<span class="hljs-string">'e.lastname'</span>, <span class="hljs-string">'e.salary'</span>, subcolumn)
.from(<span class="hljs-string">'employee as e'</span>)
.whereRaw(<span class="hljs-string">'dept_no = e.dept_no'</span>)</code></pre>
                    <p>Note that the example above be achieved more easily using the <a href="#Builder-as">as</a> method.</p><pre class="display"><code class="js hljs"><span class="hljs-keyword">var</span> subcolumn = knex.avg(<span class="hljs-string">'salary'</span>)
.from(<span class="hljs-string">'employee'</span>)
.whereRaw(<span class="hljs-string">'dept_no = e.dept_no'</span>)
.as(<span class="hljs-string">'avg_sal_dept'</span>);

knex.select(<span class="hljs-string">'e.lastname'</span>, <span class="hljs-string">'e.salary'</span>, subcolumn)
.from(<span class="hljs-string">'employee as e'</span>)
.whereRaw(<span class="hljs-string">'dept_no = e.dept_no'</span>)</code></pre></div>
                <div id="Utility">
                    <h2 id="Utility">Utility</h2>
                    <p>A collection of utilities that the knex library provides for convenience.</p>
                    <h3 id="Utility-BatchInsert">Batch Insert</h3>
                    <div>
                        <p>The <code>batchInsert</code> utility will insert a batch of rows wrapped inside a transaction <em>(which is automatically created unless explicitly given a transaction using <a href="#Builder-transacting">transacting</a>)</em>, at a given <code>chunkSize</code>.</p>
                        <p>It&#39;s primarily designed to be used when you have thousands of rows to insert into a table.</p>
                        <p>By default, the <code>chunkSize</code> is set to 1000.</p>
                        <p>BatchInsert also allows for <a href="#Builder-returning">returning values</a> and supplying transactions using <a href="#Builder-transacting">transacting</a>.</p>
                    </div><pre><code class="hljs js"><span class="hljs-keyword">var</span> rows = [{...}, {...}];
<span class="hljs-keyword">var</span> chunkSize = <span class="hljs-number">30</span>;
knex.batchInsert(<span class="hljs-string">'TableName'</span>, rows, chunkSize)
.returning(<span class="hljs-string">'id'</span>)
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ids</span>) </span>{ ... })
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{ ... });

knex.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tr</span>) </span>{
<span class="hljs-keyword">return</span> knex.batchInsert(<span class="hljs-string">'TableName'</span>, rows, chunkSize)
  .transacting(tr)
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ ... })
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{ ... });</code></pre></div>
                <div id="Interfaces">
                    <h2 id="Interfaces">Interfaces</h2>
                    <p>Knex.js provides several options to deal with query output. The following methods are present on the query builder, schema builder, and the raw builder:</p>
                    <h3 id="Interfaces-Promises">Promises</h3>
                    <p><a href="https://github.com/petkaantonov/bluebird#what-are-promises-and-why-should-i-use-them">Promises</a> are the preferred way of dealing with queries in knex, as they allow you to return values from a fulfillment handler, which in turn become the value of the promise. The main benefit of promises are the ability to catch thrown errors without crashing the node app, making your code behave like a <strong>.try / .catch / .finally</strong> in synchronous code.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'name'</span>)
.from(<span class="hljs-string">'users'</span>)
.where(<span class="hljs-string">'id'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">20</span>)
.andWhere(<span class="hljs-string">'id'</span>, <span class="hljs-string">'&lt;'</span>, <span class="hljs-number">200</span>)
.limit(<span class="hljs-number">10</span>)
.offset(x)
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rows</span>) </span>{
<span class="hljs-keyword">return</span> _.pluck(rows, <span class="hljs-string">'name'</span>);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">names</span>) </span>{
<span class="hljs-keyword">return</span> knex.select(<span class="hljs-string">'id'</span>).from(<span class="hljs-string">'nicknames'</span>).whereIn(<span class="hljs-string">'nickname'</span>, names);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rows</span>) </span>{
<span class="hljs-built_in">console</span>.log(rows);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
<span class="hljs-built_in">console</span>.error(error)
});</code></pre>
                    <div id="Interfaces-then"><b>then</b> — <code>.then(onFulfilled)</code>
                        <p>Coerces the current query builder chain into a promise state, accepting the resolve and reject handlers as specified by the Promises/A+ spec. As stated in the spec, more than one call to the then method for the current query chain will resolve with the same value, in the order they were called; the query will not be executed multiple times.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'*'</span>)
.from(<span class="hljs-string">'users'</span>)
.where({name: <span class="hljs-string">'Tim'</span>})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rows</span>) </span>{
<span class="hljs-keyword">return</span> knex.insert({user_id: rows[<span class="hljs-number">0</span>].id, name: <span class="hljs-string">'Test'</span>}, <span class="hljs-string">'id'</span>).into(<span class="hljs-string">'accounts'</span>);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>) </span>{
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Inserted Account '</span> + id);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{ <span class="hljs-built_in">console</span>.error(error); });</code></pre></div>
                    <div id="Interfaces-catch"><b>catch</b> — <code>.catch(onRejected)</code>
                        <p>Coerces the current query builder into a promise state, catching any error thrown by the query, the same as calling .then(null, onRejected).</p><pre><code class="hljs js"><span class="hljs-keyword">return</span> knex.insert({id: <span class="hljs-number">1</span>, name: <span class="hljs-string">'Test'</span>}, <span class="hljs-string">'id'</span>)
.into(<span class="hljs-string">'accounts'</span>)
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
<span class="hljs-built_in">console</span>.error(error);
}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">return</span> knex.select(<span class="hljs-string">'*'</span>)
  .from(<span class="hljs-string">'accounts'</span>)
  .where(<span class="hljs-string">'id'</span>, <span class="hljs-number">1</span>);
}).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rows</span>) </span>{
<span class="hljs-built_in">console</span>.log(rows[<span class="hljs-number">0</span>]);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
<span class="hljs-built_in">console</span>.error(error);
});</code></pre></div>
                    <div id="Interfaces-tap"><b>tap</b> — <code>.tap(sideEffectHandler)</code>
                        <p>Executes side effects on the resolved response, ultimately returning a promise that fulfills with the original value. A thrown error or rejected promise will cause the promise to transition into a rejected state.</p><pre><code class="hljs js"><span class="hljs-comment">// Using only .then()</span>
query.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{
doSideEffectsHere(x);
<span class="hljs-keyword">return</span> x;
});

<span class="hljs-comment">// Using .tap()</span>
promise.tap(doSideEffectsHere);</code></pre></div>
                    <div id="Interfaces-map"><b>map</b> — <code>.map(mapper)</code>
                        <p>A passthrough to Bluebird&#x27;s map implementation with the result set.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'name'</span>).from(<span class="hljs-string">'users'</span>).limit(<span class="hljs-number">10</span>).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">row</span>) </span>{
<span class="hljs-keyword">return</span> row.name;
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">names</span>) </span>{ <span class="hljs-built_in">console</span>.log(names); })
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{ <span class="hljs-built_in">console</span>.error(e); });</code></pre></div>
                    <div id="Interfaces-reduce"><b>reduce</b> — <code>.reduce(reducer, [initialValue])</code>
                        <p>A passthrough to Bluebird&#x27;s reduce implementation with the result set.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'name'</span>).from(<span class="hljs-string">'users'</span>).limit(<span class="hljs-number">10</span>).reduce(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">memo, row</span>) </span>{
memo.names.push(row.name);
memo.count++;
<span class="hljs-keyword">return</span> memo;
}, {count: <span class="hljs-number">0</span>, names: []})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>) </span>{ <span class="hljs-built_in">console</span>.log(obj); })
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{ <span class="hljs-built_in">console</span>.error(e); });</code></pre></div>
                    <div id="Interfaces-bind"><b>bind</b> — <code>.bind(context)</code>
                        <p>A passthrough to Bluebird&#x27;s bind method which sets the context value (this) for the returned promise.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'name'</span>).from(<span class="hljs-string">'users'</span>)
.limit(<span class="hljs-number">10</span>)
.bind(<span class="hljs-built_in">console</span>)
.then(<span class="hljs-built_in">console</span>.log)
.catch(<span class="hljs-built_in">console</span>.error)</code></pre></div>
                    <div id="Interfaces-return"><b>return</b> — <code>.return(value)</code>
                        <p>Shorthand for calling .then(function() { return value }).</p><pre><code class="hljs js"><span class="hljs-comment">// Without return:</span>
knex.insert(values).into(<span class="hljs-string">'users'</span>)
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {inserted: <span class="hljs-literal">true</span>};
});

knex.insert(values).into(<span class="hljs-string">'users'</span>).return({inserted: <span class="hljs-literal">true</span>});</code></pre></div>
                    <h3 id="Interfaces-Callbacks">Callbacks</h3>
                    <div id="Interfaces-asCallback"><b>asCallback</b> — <code>.asCallback(callback)</code>
                        <p>If you&#x27;d prefer a callback interface over promises, the asCallback function accepts a standard node style callback for executing the query chain. Note that as with the then method, subsequent calls to the same query chain will return the same result.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'name'</span>).from(<span class="hljs-string">'users'</span>)
.where(<span class="hljs-string">'id'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-number">20</span>)
.andWhere(<span class="hljs-string">'id'</span>, <span class="hljs-string">'&lt;'</span>, <span class="hljs-number">200</span>)
.limit(<span class="hljs-number">10</span>)
.offset(x)
.asCallback(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, rows</span>) </span>{
<span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.error(err);
knex.select(<span class="hljs-string">'id'</span>).from(<span class="hljs-string">'nicknames'</span>)
  .whereIn(<span class="hljs-string">'nickname'</span>, _.pluck(rows, <span class="hljs-string">'name'</span>))
  .asCallback(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, rows</span>) </span>{
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.error(err);
    <span class="hljs-built_in">console</span>.log(rows);
  });
});</code></pre></div>
                    <h3 id="Interfaces-Streams">Streams</h3>
                    <p>Streams are a powerful way of piping data through as it comes in, rather than all at once. You can read more about streams <a href="https://github.com/substack/stream-handbook">here at substack&#39;s stream handbook</a>. See the following for example uses of stream &amp; pipe. If you wish to use streams with PostgreSQL, you must also install the <a href="https://github.com/brianc/node-pg-query-stream">pg-query-stream</a> module. On an HTTP server, make sure to <a href="https://github.com/tgriesser/knex/wiki/Manually-Closing-Streams">manually close your streams</a> if a request is aborted.</p>
                    <div id="Interfaces-stream"><b>stream</b> — <code>.stream([options], [callback])</code>
                        <p>If called with a callback, the callback is passed the stream and a promise is returned. Otherwise, the readable stream is returned.</p><pre><code class="hljs js"><span class="hljs-comment">// Retrieve the stream:</span>
<span class="hljs-keyword">var</span> stream = knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).stream();
stream.pipe(writableStream);

<span class="hljs-comment">// With options:</span>
<span class="hljs-keyword">var</span> stream = knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).stream({highWaterMark: <span class="hljs-number">5</span>});
stream.pipe(writableStream);

<span class="hljs-comment">// Use as a promise:</span>
<span class="hljs-keyword">var</span> stream = knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>)
.where(knex.raw(<span class="hljs-string">'id = ?'</span>, [<span class="hljs-number">1</span>]))
.stream(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">stream</span>) </span>{
  stream.pipe(writableStream);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">// ... })</span>
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{ <span class="hljs-built_in">console</span>.error(e); });</code></pre></div>
                    <div id="Interfaces-pipe"><b>pipe</b> — <code>.pipe(writableStream)</code>
                        <p>Pipe a stream for the current query to a writableStream.</p><pre><code class="hljs js"><span class="hljs-keyword">var</span> stream = knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).pipe(writableStream);</code></pre></div>
                    <h3 id="Interfaces-Events">Events</h3>
                    <div id="Interfaces-query"><b>query</b>
                        <p>A query event is fired just before a query takes place, providing data about the query, including the connection&#x27;s __cid property and any other information about the query as described in toSQL. Useful for logging all queries throughout your application.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'*'</span>)
.from(<span class="hljs-string">'users'</span>)
.on(<span class="hljs-string">'query'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
app.log(data);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-comment">// ...</span>
});</code></pre></div>
                    <div id="Interfaces-query-error"><b>query-error</b>
                        <p>A query-error event is fired when an error occurs when running a query, providing the error object and data about the query, including the connection&#x27;s __cid property and any other information about the query as described in toSQL. Useful for logging all query errors throughout your application.</p><pre><code class="hljs js">knex.select([<span class="hljs-string">'NonExistentColumn'</span>])
.from(<span class="hljs-string">'users'</span>)
.on(<span class="hljs-string">'query-error'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, obj</span>) </span>{
app.log(error);
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">// ... })</span>
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
<span class="hljs-comment">// Same error object as the query-error event provides.</span>
});</code></pre></div>
                    <div id="Interfaces-query-response"><b>query-response</b>
                        <p>A query-response event is fired when a successful query has been run, providing the response of the query and data about the query, including the connection&#x27;s __cid property and any other information about the query as described in toSQL, and finally the query builder used for the query.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'*'</span>)
.from(<span class="hljs-string">'users'</span>)
.on(<span class="hljs-string">'query-response'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response, obj, builder</span>) </span>{
<span class="hljs-comment">// ...</span>
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) </span>{
<span class="hljs-comment">// Same response as the emitted event</span>
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{ });</code></pre></div>
                    <h3 id="Interfaces-Other">Other</h3>
                    <div id="Interfaces-toString"><b>toString</b> — <code>.toString()</code>
                        <p>Returns an array of query strings filled out with the correct values based on bindings, etc. Useful for debugging.</p><pre class="display"><code class="js hljs">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).where(knex.raw(<span class="hljs-string">'id = ?'</span>, [<span class="hljs-number">1</span>])).toString()</code></pre></div>
                    <div id="Interfaces-toSQL"><b>toSQL</b> — <code>.toSQL()</code>
                        <p>Returns an array of query strings filled out with the correct values based on bindings, etc. Useful for debugging.</p><pre><code class="hljs js">knex.select(<span class="hljs-string">'*'</span>).from(<span class="hljs-string">'users'</span>).where(knex.raw(<span class="hljs-string">'id = ?'</span>, [<span class="hljs-number">1</span>])).toSQL()

<span class="hljs-comment">// Ouputs: { bindings: [1], method: 'select', sql: 'select * from "users" where id = ?', options: undefined, }</span></code></pre></div>
                </div>
                <div id="Migrations">
                    <h2 id="Migrations">Migrations</h2>
                    <p>Migrations allow for you to define sets of schema changes so upgrading a database is a breeze.</p>
                    <h3 id="Migrations-CLI">Migration CLI</h3>
                    <p>The migration CLI is bundled with the knex install, and is driven by the <a href="https://github.com/tkellen/node-liftoff">node-liftoff</a> module. To install globally, run:</p><pre><code>$ npm install knex -g</code></pre>
                    <p>Migrations use a <strong>knexfile</strong>, which specify various configuration settings for the module. To create a new knexfile, run the following:</p><pre><code>$ knex init

# or for .coffee

$ knex init -x coffee</code></pre>
                    <p>will create a sample knexfile.js - the file which contains our various database configurations. Once you have a knexfile.js, you can use the migration tool to create migration files to the specified directory (default migrations). Creating new migration files can be achieved by running:</p><pre><code>$ knex migrate:make migration_name</code></pre>
                    <p>Once you have finished writing the migrations, you can update the database matching your <code>NODE_ENV</code> by running:</p><pre><code>$ knex migrate:latest</code></pre>
                    <p>You can also pass the <code>--env</code> flag or set <code>NODE_ENV</code> to select an alternative environment:</p><pre><code>$ knex migrate:latest --env production

# or

$ NODE_ENV=production knex migrate:latest</code></pre>
                    <p>To rollback the last batch of migrations:</p><pre><code>$ knex migrate:rollback</code></pre>
                    <h2 id="Seeds">Seed files</h2>
                    <p>Seed files allow you to populate your database with test or seed data independent of your migration files.</p>
                    <h3 id="Seeds-CLI">Seed CLI</h3>
                    <p>To create a seed file, run:</p><pre><code>$ knex seed:make seed_name</code></pre>
                    <p>Seed files are created in the directory specified in your knexfile.js for the current environment. A sample seed configuration looks like:</p><pre><code>development: {
client: ...,
connection: { ... },
seeds: {
    directory: './seeds/dev'
}
}</code></pre>
                    <div>
                        <p>If no <code>seeds.directory</code> is defined, files are created in <code>./seeds</code>. Note that the seed directory needs to be a relative path. Absolute paths are not supported (nor is it good practice).</p>
                        <p>To run seed files, execute:</p>
                    </div><pre><code>$ knex seed:run</code></pre>
                    <p>Seed files are executed in alphabetical order. Unlike migrations, <em>every</em> seed file will be executed when you run the command. You should design your seed files to reset tables as needed before inserting data.</p>
                    <h3 id="knexfile">knexfile.js</h3>
                    <p>A knexfile.js or knexfile.coffee generally contains all of the configuration for your database. It can optionally provide different configuration for different environments. You may pass a <code>--knexfile</code> option to any of the command line statements to specify an alternate path to your knexfile.</p>
                    <h4>Basic configuration:</h4><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = {
client: <span class="hljs-string">'pg'</span>,
connection: process.env.DATABASE_URL || { user: <span class="hljs-string">'me'</span>, database: <span class="hljs-string">'my_app'</span> }
};</code></pre>
                    <h4>Environment configuration:</h4><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = {
development: {
  client: <span class="hljs-string">'pg'</span>,
  connection: { user: <span class="hljs-string">'me'</span>, database: <span class="hljs-string">'my_app'</span> }
},
production: { client: <span class="hljs-string">'pg'</span>, connection: process.env.DATABASE_URL }
};</code></pre>
                    <h3 id="Migrations-API">Migration API</h3>
                    <div>
                        <p><code>knex.migrate</code> is the class utilized by the knex migrations cli.</p>
                        <p>Each method takes an optional <code>config</code> object, which may specify the following properties:</p>
                    </div>
                    <ul>
                        <li><code>directory</code>: a relative path to the directory containing the migration files (default <code>./migrations</code>)</li>
                        <li><code>extension</code>: the file extension used for the generated migration files (default <code>js</code>)</li>
                        <li><code>tableName</code>: the table name used for storing the migration state (default <code>knex_migrations</code>)</li>
                        <li><code>disableTransactions</code>: don&#39;t run migrations inside transactions (default <code>false</code>)</li>
                    </ul>
                    <h4 id="Migrations-API-transactions">Transactions in migrations</h4>
                    <p>By default, each migration is run inside a transaction. Whenever needed, one can disable transactions for all migrations via the common migration config option <code>config.disableTransactions</code> or per-migration, via exposing a boolean property <code>config.transaction</code> from a migration file:</p><pre><code class="hljs js">exports.up = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">knex, Promise</span>) </span>{ <span class="hljs-comment">/* ... */</span> };

exports.down = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">knex, Promise</span>) </span>{ <span class="hljs-comment">/* ... */</span> };

exports.config = { transaction: <span class="hljs-literal">false</span> };</code></pre>
                    <p>The same config property can be used for enabling transaction per-migration in case the common configuration has <code>disableTransactions: true</code>.</p>
                    <div id="Migrations-make"><b>make</b> — <code>knex.migrate.make(name, [config])</code>
                        <p>Creates a new migration, with the name of the migration being added.</p>
                    </div>
                    <div id="Migrations-latest"><b>latest</b> — <code>knex.migrate.latest([config])</code>
                        <p>Runs all migrations that have not yet been run.</p>
                    </div>
                    <p>If you need to run something only after all migrations have finished their execution, you can do something like this:</p><pre><code class="hljs js">knex.migrate.latest()
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">return</span> knex.seed.run();
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-comment">// migrations are finished</span>
});</code></pre>
                    <div id="Migrations-rollback"><b>rollback</b> — <code>knex.migrate.rollback([config])</code>
                        <p>Rolls back the latest migration group.</p>
                    </div>
                    <div id="Migrations-currentVersion"><b>currentVersion</b> — <code>knex.migrate.currentVersion([config])</code>
                        <p>Retrieves and returns the current migration version, as a promise. If there aren&#x27;t any migrations run yet, returns &quot;none&quot; as the value for the currentVersion.</p>
                    </div>
                </div>
                <div id="Seeds">
                    <h3 id="Seeds-API">Seed API</h3>
                    <p><code>knex.seed</code> is the class utilized by the knex seed CLI. Each method takes an optional <code>config</code> object, which may specify the relative <code>directory</code> for the migrations.</p>
                    <div id="Seeds-make"><b>make</b> — <code>knex.seed.make(name, [config])</code>
                        <p>Creates a new seed file, with the name of the seed file being added.</p>
                    </div>
                    <div id="Seeds-run"><b>run</b> — <code>knex.seed.run([config])</code>
                        <p>Runs all seed files for the current environment.</p>
                    </div>
                </div>
                <div id="Support">
                    <h2 id="support">Support</h2>
                    <p>Have questions about the library? Come join us in the <a href="http://webchat.freenode.net/?channels=bookshelf">#bookshelf freenode IRC</a> channel for support on knex.js and <a href="http://bookshelfjs.org">bookshelf.js</a>, or post an issue on <a href="http://stackoverflow.com/questions/tagged/knex.js">Stack Overflow</a> or in the GitHub <a href="https://github.com/tgriesser/knex/issues">issue tracker</a>.</p>
                </div>
                <div id="Faq">
                    <h2 id="faq">F.A.Q.</h2>
                    <div>
                        <p><strong>How do I help contribute?</strong>
                            <br>Glad you ask! Pull requests, or feature requests, though not always implemented, are a great way to help make Knex even better than it is now. If you&#39;re looking for something specific to help out with, there&#39;s a number of unit tests that aren&#39;t implemented yet, the library could never have too many of those. If you want to submit a fix or feature, take a look at the <a href="https://github.com/tgriesser/knex/blob/master/CONTRIBUTING.md">Contributing</a> readme in the Github and go ahead and open a ticket.</p>
                        <p><strong>How do I debug?</strong>
                            <br>Knex is beginning to make use of the <a href="https://github.com/visionmedia/debug">debug</a> module internally, so you can set the <code>DEBUG</code> environment variable to <code>knex:*</code> to see all debugging, or select individual namespaces <code>DEBUG=knex:query,knex:tx</code> to constrain a bit.</p>
                        <p>If you pass <code>{debug: true}</code> as one of the options in your initialize settings, you can see all of the query calls being made. Sometimes you need to dive a bit further into the various calls and see what all is going on behind the scenes. I&#39;d recommend <a href="https://github.com/dannycoates/node-inspector">node-inspector</a>, which allows you to debug code with <code>debugger</code> statements like you would in the browser.</p>
                        <p>At the start of your application code will catch any errors not otherwise caught in the normal promise chain handlers, which is very helpful in debugging.</p>
                        <p><strong>How do I run the test suite?</strong>
                            <br>The test suite looks for an environment variable called <code>KNEX_TEST</code> for the path to the database configuration. If you run the following command:</p>
                    </div><pre><code>$ export KNEX_TEST='/path/to/your/knex_config.js'
$ npm test</code></pre>
                    <div>
                        <p>replacing with the path to your config file, and the config file is valid, the test suite should run properly.</p>
                        <p><strong>My tests are failing because slow DB connection and short test timeouts! How to extend test timeouts?</strong>
                            <br>Sometimes, e.g. when running CI on travis, test suite&#39;s default timeout of 5 seconds might be too short. In such cases an alternative test timeout value in milliseconds can be specified using the <code>KNEX_TEST_TIMEOUT</code> environment variable.</p>
                    </div><pre><code>$ export KNEX_TEST_TIMEOUT=30000
$ npm test</code></pre>
                    <p><strong>Can I use Knex outside of Node.js</strong>
                        <br>Yes. While the WebSQL spec is deprecated, there is still an adapter that provides support. Checkout the <a href="https://github.com/tgriesser/knex/tree/master/build">browser builds</a> for more details.</p>
                </div>
                <div id="changelog">
                    <div><b class="header">0.11.9</b> — <small><i>21 Jul, 2016</i></small>
                        <br/>
                        <p>Reverted knex client breaking change (commit b74cd69e906), fixes <a href="https://github.com/tgriesser/knex/issues/1587">#1587</a></p>
                    </div>
                    <div><b class="header">0.11.8</b> — <small><i>21 Jul, 2016</i></small>
                        <br/>
                        <ul>
                            <li>Oracledb dialect <a href="https://github.com/tgriesser/knex/issues/990">#990</a></li>
                            <li>Documentation fix <a href="https://github.com/tgriesser/knex/issues/1532">#1532</a></li>
                            <li>Allow named bindings to be escaped. <a href="https://github.com/tgriesser/knex/issues/1576">#1576</a></li>
                            <li>Several bugs with MS SQL schema creation and installing from gihub fix <a href="https://github.com/tgriesser/knex/issues/1577">#1577</a></li>
                            <li>Fix incorrect escaping of backslashes in SqlString.escape <a href="https://github.com/tgriesser/knex/issues/1545">#1545</a></li>
                        </ul>
                    </div>
                    <div><b class="header">0.11.7</b> — <small><i>19 Jun, 2016</i></small>
                        <br/>
                        <p>Add missing dependency. <a href="https://github.com/tgriesser/knex/issues/1516">#1516</a></p>
                    </div>
                    <div><b class="header">0.11.6</b> — <small><i>18 Jun, 2016</i></small>
                        <br/>
                        <ul>
                            <li>Allow cancellation on timeout (MySQL) <a href="https://github.com/tgriesser/knex/issues/1454">#1454</a></li>
                            <li>Better bigint support. (MSSQL) <a href="https://github.com/tgriesser/knex/issues/1445">#1445</a></li>
                            <li>More consistent handling of <code>undefined</code> values in <code>QueryBuilder#where</code> and <code>Raw</code>. <a href="https://github.com/tgriesser/knex/issues/1459">#1459</a></li>
                            <li>Fix Webpack build. <a href="https://github.com/tgriesser/knex/issues/1447">#1447</a></li>
                            <li>Fix code that triggered Bluebird warnings. <a href="https://github.com/tgriesser/knex/issues/1460">#1460</a>, <a href="https://github.com/tgriesser/knex/issues/1489">#1489</a></li>
                            <li>Fix <code>ping</code> function. (Oracle) <a href="https://github.com/tgriesser/knex/issues/1486">#1486</a></li>
                            <li>Fix <code>columnInfo</code>. (MSSQL) <a href="https://github.com/tgriesser/knex/issues/1464">#1464</a></li>
                            <li>Fix <code>ColumnCompiler#binary</code>. (MSSQL) <a href="https://github.com/tgriesser/knex/issues/1464">#1464</a></li>
                            <li>Allow connection strings that do not contain a password. <a href="https://github.com/tgriesser/knex/issues/1473">#1473</a></li>
                            <li>Fix race condition in seed stubs. <a href="https://github.com/tgriesser/knex/issues/1493">#1493</a></li>
                            <li>Give each query a UUID. <a href="https://github.com/tgriesser/knex/issues/1510">#1510</a></li>
                        </ul>
                    </div>
                    <div><b class="header">0.11.5</b> — <small><i>26 May, 2016</i></small>
                        <br/>
                        <p>Bugfix: Using <code>Raw</code> or <code>QueryBuilder</code> as a binding to <code>Raw</code> now works as intended.</p>
                    </div>
                    <div><b class="header">0.11.4</b> — <small><i>22 May, 2016</i></small>
                        <br/>
                        <ul>
                            <li>Bugfix: Inconsistency of <code>.primary()</code> and <code>.dropPrimary()</code> between dialects <a href="https://github.com/tgriesser/knex/issues/1430">#1430</a></li>
                            <li>Feature: Allow using custom Client/Dialect (you can pass your own client in knex config) <a href="https://github.com/tgriesser/knex/issues/1428">#1428</a></li>
                            <li>Docs: Add documentation for .dropTimestamps <a href="https://github.com/tgriesser/knex/issues/1432">#1432</a></li>
                            <li>Bugfix: Fixed passing undefined fields for insert/update inside transaction <a href="https://github.com/tgriesser/knex/issues/1423">#1423</a></li>
                            <li>Feature: <code>batchInsert</code> with existing transaction <a href="https://github.com/tgriesser/knex/issues/1354">#1354</a></li>
                            <li>Build: eslint instead of jshint <a href="https://github.com/tgriesser/knex/issues/1416">#1416</a></li>
                            <li>Bugfix: Pooled connections not releasing <a href="https://github.com/tgriesser/knex/issues/1382">#1382</a></li>
                            <li>Bugfix: Support passing <code>knex.raw</code> to <code>.whereNot</code> <a href="https://github.com/tgriesser/knex/issues/1402">#1402</a></li>
                            <li>Docs: Fixed list of dialects which supports <code>.returning</code> <a href="https://github.com/tgriesser/knex/issues/1398">#1398</a></li>
                            <li>Bugfix: rename table does not fail anymore even with schema defined <a href="https://github.com/tgriesser/knex/issues/1403">#1403</a></li>
                        </ul>
                    </div>
                    <div><b class="header">0.11.3</b> — <small><i>14 May, 2016</i></small>
                        <br/>
                        <p>Support nested joins. <a href="https://github.com/tgriesser/knex/issues/1397">#1397</a></p>
                    </div>
                    <div><b class="header">0.11.2</b> — <small><i>14 May, 2016</i></small>
                        <br/>
                        <ul>
                            <li>Prevent crash on <code>knex seed:make</code>. <a href="https://github.com/tgriesser/knex/issues/1389">#1389</a></li>
                            <li>Improvements to <code>batchInsert</code>. <a href="https://github.com/tgriesser/knex/issues/1391">#1391</a></li>
                            <li>Improvements to inserting <code>DEFAULT</code> with <code>undefined</code> binding. <a href="https://github.com/tgriesser/knex/issues/1396">#1396</a></li>
                            <li>Correct generated code for adding/dropping multiple columns. (MSSQL) <a href="https://github.com/tgriesser/knex/issues/1401">#1401</a></li>
                        </ul>
                    </div>
                    <div><b class="header">0.11.1</b> — <small><i>6 May, 2016</i></small>
                        <br/>
                        <p>Fix error in CLI command <code>migrate:make</code>. <a href="https://github.com/tgriesser/knex/issues/1386">#1386</a></p>
                    </div>
                    <div><b class="header">0.11.0</b> — <small><i>5 May, 2016</i></small>
                        <br/><b>Breaking Changes:</b>
                        <ul>
                            <li><code>QueryBuilder#orWhere</code> joins multiple arguments with <code>AND</code>. <a href="https://github.com/tgriesser/knex/issues/1164">#1164</a></li>
                        </ul><b>Other Changes:</b>
                        <ul>
                            <li>Collate for columns. (MySQL) <a href="https://github.com/tgriesser/knex/issues/1147">#1147</a></li>
                            <li>Add <code>QueryBuilder#timeout</code>, <code>Raw#timeout</code>. <a href="https://github.com/tgriesser/knex/issues/1201">#1201</a> <a href="https://github.com/tgriesser/knex/issues/1260">#1260</a></li>
                            <li>Exit with error code when appropriate. <a href="https://github.com/tgriesser/knex/issues/1238">#1238</a></li>
                            <li>MSSQL connection accepts <code>host</code> as an alias for <code>server</code> in accordance with other dialects. <a href="https://github.com/tgriesser/knex/issues/1239">#1239</a></li>
                            <li>Add <code>query-response</code> event. <a href="https://github.com/tgriesser/knex/issues/1231">#1231</a></li>
                            <li>Correct behaviour of sibling nested transactions. <a href="https://github.com/tgriesser/knex/issues/1226">#1226</a></li>
                            <li>Support <code>RETURNING</code> with <code>UPDATE</code>. (Oracle) <a href="https://github.com/tgriesser/knex/issues/1253">#1253</a></li>
                            <li>Throwing callbacks from transactions automatically rolls them back. <a href="https://github.com/tgriesser/knex/issues/1257">#1257</a></li>
                            <li>Fixes to named <code>Raw</code> bindings. <a href="https://github.com/tgriesser/knex/issues/1251">#1251</a></li>
                            <li><code>timestamps</code> accepts an argument to set <code>NOT NULL</code> and default to current timestamp.</li>
                            <li>Add <code>TableBuilder#inherits</code> for PostgreSQL. <a href="https://github.com/tgriesser/knex/issues/601">#601</a></li>
                            <li>Wrap index names. <a href="https://github.com/tgriesser/knex/issues/1289">#1289</a></li>
                            <li>Restore coffeescript knexfiles and configurations. <a href="https://github.com/tgriesser/knex/issues/1292">#1292</a></li>
                            <li>Add <code>andWhereBetween</code> and <code>andWhereNotBetween</code> <a href="https://github.com/tgriesser/knex/issues/1132">#1132</a></li>
                            <li>Fix <code>valueForUndefined</code> failure. <a href="https://github.com/tgriesser/knex/issues/1269">#1269</a></li>
                            <li><code>renameColumn</code> no longer drops default value or nullability. <a href="https://github.com/tgriesser/knex/issues/1326">#1326</a></li>
                            <li>Correct MySQL2 error handling. <a href="https://github.com/tgriesser/knex/issues/1315">#1315</a></li>
                            <li>Fix MSSQL <code>createTableIfNotExists</code>. <a href="https://github.com/tgriesser/knex/issues/1362">#1362</a></li>
                            <li>Fix MSSQL URL parsing. <a href="https://github.com/tgriesser/knex/issues/1342">#1342</a></li>
                            <li>Update Lodash to 4.6.0 <a href="https://github.com/tgriesser/knex/issues/1242">#1242</a></li>
                            <li>Update Bluebird to 3.3.4 <a href="https://github.com/tgriesser/knex/issues/1279">#1279</a></li>
                        </ul>
                    </div>
                    <div><a href="#">Show Full Changelog</a>
                        <div class="more-changelog">
                            <div><b class="header">0.10.0</b> — <small><i>15 Feb, 2016</i></small>
                                <br/><b>Breaking Changes:</b>
                                <ul>
                                    <li><code>insert</code> and <code>update</code> now ignore <code>undefined</code> values. Back compatibility is provided through the option <code>useNullAsDefault</code>. <a href="https://github.com/tgriesser/knex/issues/1174">#1174</a>, <a href="https://github.com/tgriesser/knex/issues/1043">#1043</a></li>
                                </ul><b>Other Changes:</b>
                                <ul>
                                    <li>Add <a href="#Builder-countDistinct"><code>countDistinct</code></a>, <a href="#Builder-avgDistinct"><code>avgDistinct</code></a> and <a href="#Builder-sumDistinct"><code>sumDistinct</code></a>. <a href="https://github.com/tgriesser/knex/issues/1046">#1046</a></li>
                                    <li>Add <a href="#Schema-jsonb"><code>schema.jsonb</code></a>. Deprecated <code>schema.json(column, true)</code>. <a href="https://github.com/tgriesser/knex/issues/991">#991</a></li>
                                    <li>Support binding identifiers with <code>??</code>. <a href="https://github.com/tgriesser/knex/issues/1103">#1103</a></li>
                                    <li>Restore <code>query</code> event when triggered by transactions. <a href="https://github.com/tgriesser/knex/issues/855">#855</a></li>
                                    <li>Correct question mark escaping in rendered queries. <a href="https://github.com/tgriesser/knex/issues/519">#519</a>, <a href="https://github.com/tgriesser/knex/issues/1058">#1058</a></li>
                                    <li>Add per-dialect escaping, allowing quotes to be escaped correctly. <a href="https://github.com/tgriesser/knex/issues/886">#886</a>, <a href="https://github.com/tgriesser/knex/issues/1095">#1095</a></li>
                                    <li>Add MSSQL support. <a href="https://github.com/tgriesser/knex/issues/1090">#1090</a></li>
                                    <li>Add migration locking. <a href="https://github.com/tgriesser/knex/issues/1094">#1094</a></li>
                                    <li>Allow column aliases to contain <code>.</code>. <a href="https://github.com/tgriesser/knex/issues/1181">#1181</a></li>
                                    <li>Add <code>batchInsert</code>. <a href="https://github.com/tgriesser/knex/issues/1182">#1182</a></li>
                                    <li>Support non-array arguments to <a href="#Raw-Bindings"><code>knex.raw</code></a>.</li>
                                    <li>Global <code>query-error</code> event. <a href="https://github.com/tgriesser/knex/issues/1163">#1163</a></li>
                                    <li>Add <code>batchInsert</code>. <a href="https://github.com/tgriesser/knex/issues/1182">#1182</a></li>
                                    <li>Better support for Mysql2 dialect options. <a href="https://github.com/tgriesser/knex/issues/980">#980</a></li>
                                    <li>Support for <code>acquireConnectionTimeout</code> default 60 seconds preventing <a href="https://github.com/tgriesser/knex/issues/1040">#1040</a> from happening. <a href="https://github.com/tgriesser/knex/issues/1177">#1177</a></li>
                                    <li>Fixed constraint name escaping when dropping a constraint. <a href="https://github.com/tgriesser/knex/issues/1177">#1177</a></li>
                                    <li>Show also <code>.raw</code> queries in debug output. <a href="https://github.com/tgriesser/knex/issues/1169">#1169</a></li>
                                    <li>Support for <code>cli</code> to use basic configuration without specific environment set. <a href="https://github.com/tgriesser/knex/issues/1101">#1101</a></li>
                                </ul>
                            </div>
                            <div><b class="header">0.9.0</b> — <small><i>Nov 2, 2015</i></small>
                                <br/>
                                <ul>
                                    <li>Fix error when merging <code>knex.raw</code> instances without arguments. <a href="https://github.com/tgriesser/knex/issues/853">#853</a></li>
                                    <li>Fix error that caused the connection to time out while streaming. <a href="https://github.com/tgriesser/knex/issues/849">#849</a></li>
                                    <li>Correctly parse SSL query parameter for PostgreSQL. <a href="https://github.com/tgriesser/knex/issues/852">#852</a></li>
                                    <li>Pass <code>compress</code> option to MySQL2. <a href="https://github.com/tgriesser/knex/issues/843">#843</a></li>
                                    <li>Schema: Use <code>timestamp with timezone</code> by default for <code>time</code>, <code>datetime</code> and <code>timestamp</code> for Oracle. <a href="https://github.com/tgriesser/knex/issues/876">#876</a></li>
                                    <li>Add <a href="#Builder-modify"><code>QueryBuilder#modify</code></a> <a href="https://github.com/tgriesser/knex/issues/881">#881</a></li>
                                    <li>Add LiveScript and Early Gray support for seeds and migrations.</li>
                                    <li>Add <a href="#Builder-withSchema"><code>QueryBuilder#withSchema</code></a> <a href="https://github.com/tgriesser/knex/issues/518">#518</a></li>
                                    <li>Allow escaping of <code>?</code> in <code>knex.raw</code> queries. <a href="https://github.com/tgriesser/knex/issues/946">#946</a></li>
                                    <li>Allow <code>0</code> in join clause. <a href="https://github.com/tgriesser/knex/issues/953">#953</a></li>
                                    <li>Add migration config to allow disabling/enabling transactions per migration. <a href="https://github.com/tgriesser/knex/issues/834">#834</a></li>
                                </ul>
                            </div>
                            <div><b class="header">0.8.6</b> — <small><i>May 20, 2015</i></small>
                                <br/>
                                <p>Fix for several transaction / migration issues, <a href="https://github.com/tgriesser/knex/issues/832">#832</a>, <a href="https://github.com/tgriesser/knex/issues/833">#833</a>, <a href="https://github.com/tgriesser/knex/issues/834">#834</a>, <a href="https://github.com/tgriesser/knex/issues/835">#835</a>.</p>
                            </div>
                            <div><b class="header">0.8.5</b> — <small><i>May 14, 2015</i></small>
                                <br/>
                                <p>Pool should be initialized if no pool options are specified.</p>
                            </div>
                            <div><b class="header">0.8.4</b> — <small><i>May 13, 2015</i></small>
                                <br/>
                                <p>Pool should not be initialized if {max: 0} is sent in config options.</p>
                            </div>
                            <div><b class="header">0.8.3</b> — <small><i>May 2, 2015</i></small>
                                <br/>
                                <p>Alias postgresql -&gt; postgres in connection config options.</p>
                            </div>
                            <div><b class="header">0.8.2</b> — <small><i>May 1, 2015</i></small>
                                <br/>
                                <p>Fix regression in using query string in connection config.</p>
                            </div>
                            <div><b class="header">0.8.1</b> — <small><i>May 1, 2015</i></small>
                                <br/>
                                <ul>
                                    <li>Warn rather than error when implicit commits wipe out savepoints in mysql / mariadb, <a href="https://github.com/tgriesser/knex/issues/805">#805</a>.</li>
                                    <li>Fix for incorrect seed config reference, <a href="https://github.com/tgriesser/knex/issues/804">#804</a>.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.8.0</b> — <small><i>Apr 30, 2015</i></small>
                                <br/><b>New Features:</b>
                                <ul>
                                    <li>Fixes several major outstanding bugs with the connection pool, switching to <a href="https://github.com/myndzi/pool2">Pool2</a> in place of generic-pool-redux</li>
                                    <li>strong-oracle module support</li>
                                    <li>Nested transactions automatically become savepoints, with <code>commit</code> &amp; <code>rollback</code> releasing or rolling back the current savepoint.</li>
                                    <li>Database seed file support, <a href="https://github.com/tgriesser/knex/issues/391">#391</a></li>
                                    <li>Improved support for sub-raw queries within raw statements</li>
                                    <li>Migrations are now wrapped in transactions where possible</li>
                                    <li>Subqueries supported in insert statements, <a href="https://github.com/tgriesser/knex/issues/627">#627</a></li>
                                    <li>Support for nested having, <a href="https://github.com/tgriesser/knex/issues/572">#572</a></li>
                                    <li>Support object syntax for joins, similar to &quot;where&quot; <a href="https://github.com/tgriesser/knex/issues/743">#743</a></li>
                                </ul><b>Major Changes:</b>
                                <ul>
                                    <li>Transactions are immediately invoked as A+ promises, <a href="https://github.com/tgriesser/knex/issues/470">#470</a> (this is a feature and should not actually break anything in practice)</li>
                                    <li>Heavy refactoring internal APIs (public APIs should not be affected)</li>
                                </ul><b>Other Changes:</b>
                                <ul>
                                    <li>Allow mysql2 to use non-default port, <a href="https://github.com/tgriesser/knex/issues/588">#588</a></li>
                                    <li>Support creating &amp; dropping extensions in PostgreSQL, <a href="https://github.com/tgriesser/knex/issues/540">#540</a></li>
                                    <li>CLI support for knexfiles that do not provide environment keys, <a href="https://github.com/tgriesser/knex/issues/527">#527</a></li>
                                    <li>Added sqlite3 dialect version of whereRaw/andWhereRaw ( <a href="https://github.com/tgriesser/knex/issues/477">#477</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.7.5</b> — <small><i>Mar 9, 2015</i></small>
                                <br/>
                                <p>Fix bug in validateMigrationList, ( <a href="https://github.com/tgriesser/knex/issues/697">#697</a>).</p>
                            </div>
                            <div><b class="header">0.7.4</b> — <small><i>Feb 25, 2015</i></small>
                                <br/>
                                <ul>
                                    <li>Fix incorrect order of query parameters when using subqueries, <a href="https://github.com/tgriesser/knex/issues/704">#704</a></li>
                                    <li>Properly handle limit 0, ( <a href="https://github.com/tgriesser/knex/issues/655">#655</a>)</li>
                                    <li>Apply promise args from then instead of <a href="https://github.com/petkaantonov/bluebird/issues/482">explicitly passing</a>.</li>
                                    <li>Respect union parameter as last argument ( <a href="https://github.com/tgriesser/knex/issues/660">#660</a>).</li>
                                    <li>Added sqlite3 dialect version of whereRaw/andWhereRaw ( <a href="https://github.com/tgriesser/knex/issues/477">#477</a>).</li>
                                    <li>Fix SQLite dropColumn doesn&#39;t work for last column ( <a href="https://github.com/tgriesser/knex/issues/544">#544</a>).</li>
                                    <li>Add POSIX operator support for Postgres ( <a href="https://github.com/tgriesser/knex/issues/562">#562</a>)</li>
                                    <li>Sample seed files now correctly ( <a href="https://github.com/tgriesser/knex/issues/391">#391</a>)</li>
                                </ul>
                            </div>
                            <div><b class="header">0.7.3</b> — <small><i>Oct 3, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Support for <code>join(table, rawOrBuilder)</code> syntax.</li>
                                    <li>Fix for regression in PostgreSQL connection ( <a href="https://github.com/tgriesser/knex/issues/516">#516</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.7.2</b> — <small><i>Oct 1, 2014</i></small>
                                <br/>
                                <p>Fix for regression in migrations.</p>
                            </div>
                            <div><b class="header">0.7.1</b> — <small><i>Oct 1, 2014</i></small>
                                <br/>
                                <p>Better disconnect handling &amp; pool removal for MySQL clients, <a href="https://github.com/tgriesser/knex/issues/452">#452</a>.</p>
                            </div>
                            <div><b class="header">0.7.0</b> — <small><i>Oct 1, 2014</i></small>
                                <br/><b>New Features:</b>
                                <ul>
                                    <li>Oracle support, <a href="https://github.com/tgriesser/knex/issues/419">#419</a></li>
                                    <li>Database seed file support, <a href="https://github.com/tgriesser/knex/issues/391">#391</a></li>
                                    <li>Improved support for sub-raw queries within raw statements</li>
                                </ul><b>Breaking Changes:</b>
                                <ul>
                                    <li>&quot;collate nocase&quot; no longer used by default in sqlite3 <a href="https://github.com/tgriesser/knex/issues/396">#396</a></li>
                                </ul><b>Other Changes:</b>
                                <ul>
                                    <li>Bumping Bluebird to ^2.x</li>
                                    <li>Transactions in websql are now a no-op (unsupported) <a href="https://github.com/tgriesser/knex/issues/375">#375</a></li>
                                    <li>Improved test suite</li>
                                    <li>knex.fn namespace as function helper (knex.fn.now), <a href="https://github.com/tgriesser/knex/issues/372">#372</a></li>
                                    <li>Better handling of disconnect errors</li>
                                    <li>Support for offset without limit, <a href="https://github.com/tgriesser/knex/issues/446">#446</a></li>
                                    <li>Chainable first method for mysql schema, <a href="https://github.com/tgriesser/knex/issues/406">#406</a></li>
                                    <li>Support for empty array in <code>whereIn</code></li>
                                    <li>Create/drop schema for postgres, <a href="https://github.com/tgriesser/knex/issues/511">#511</a></li>
                                    <li>Inserting multiple rows with default values, <a href="https://github.com/tgriesser/knex/issues/468">#468</a></li>
                                    <li>Join columns are optional for cross-join, <a href="https://github.com/tgriesser/knex/issues/508">#508</a></li>
                                    <li>Flag for creating jsonb columns in Postgresql, <a href="https://github.com/tgriesser/knex/issues/500">#500</a></li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.22</b> — <small><i>July 10, 2014</i></small>
                                <br/>
                                <p>Bug fix for properly binding postgresql streaming queries, ( <a href="https://github.com/tgriesser/knex/issues/363">#363</a>).</p>
                            </div>
                            <div><b class="header">0.6.21</b> — <small><i>July 9, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Bug fix for raw queries not being transaction context aware, ( <a href="https://github.com/tgriesser/knex/issues/351">#351</a>).</li>
                                    <li>Properly forward stream errors in sqlite3 runner, ( <a href="https://github.com/tgriesser/knex/issues/359">#359</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.20</b> — <small><i>June 30, 2014</i></small>
                                <br/>
                                <p>Allow case insensitive operators in sql clauses, ( <a href="https://github.com/tgriesser/knex/issues/344">#344</a>).</p>
                            </div>
                            <div><b class="header">0.6.19</b> — <small><i>June 27, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Add <code>groupByRaw</code> / <code>orderByRaw</code> methods, better support for raw statements in group / order ( <a href="https://github.com/tgriesser/knex/issues/282">#282</a>).</li>
                                    <li>Support more config options for node-mysql2 dialect ( <a href="https://github.com/tgriesser/knex/issues/341">#341</a>).</li>
                                    <li>CLI help text fix, ( <a href="https://github.com/tgriesser/knex/issues/342">#342</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.18</b> — <small><i>June 25, 2014</i></small>
                                <br/>
                                <p>Patch for the method, calling without a handler should return the stream, not a promise ( <a href="https://github.com/tgriesser/knex/issues/337">#337</a>).</p>
                            </div>
                            <div><b class="header">0.6.17</b> — <small><i>June 23, 2014</i></small>
                                <br/>
                                <p>Adding missing map / reduce proxies to bluebird&#39;s implementation.</p>
                            </div>
                            <div><b class="header">0.6.16</b> — <small><i>June 18, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Increment / decrement returns the number of affectedRows ( <a href="https://github.com/tgriesser/knex/issues/330">#330</a>).</li>
                                    <li>Allow --cwd option flag to be passed to CLI tool ( <a href="https://github.com/tgriesser/knex/issues/326">#326</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.15</b> — <small><i>June 14, 2014</i></small>
                                <br/>
                                <p>Added the as method for aliasing subqueries.</p>
                            </div>
                            <div><b class="header">0.6.14</b> — <small><i>June 14, 2014</i></small>
                                <br/>
                                <p>whereExists / whereNotExists may now take a query builder instance as well as a callback.</p>
                            </div>
                            <div><b class="header">0.6.13</b> — <small><i>June 12, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Fix regression with onUpdate / onDelete in PostgreSQL, ( <a href="https://github.com/tgriesser/knex/issues/308">#308</a>).</li>
                                    <li>Add missing <code>Promise</code> require to knex.js, unit test for knex.destroy ( <a href="https://github.com/tgriesser/knex/issues/314">#314</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.12</b> — <small><i>June 10, 2014</i></small>
                                <br/>
                                <p>Fix for regression with boolean default types in PostgreSQL.</p>
                            </div>
                            <div><b class="header">0.6.11</b> — <small><i>June 10, 2014</i></small>
                                <br/>
                                <p>Fix for regression with queries containing multiple order by statements in sqlite3.</p>
                            </div>
                            <div><b class="header">0.6.10</b> — <small><i>June 10, 2014</i></small>
                                <br/>
                                <p>Fix for big regression in memoization of column names from 0.5 -&gt; 0.6.</p>
                            </div>
                            <div><b class="header">0.6.9</b> — <small><i>June 9, 2014</i></small>
                                <br/>
                                <p>Fix for regression in specificType method.</p>
                            </div>
                            <div><b class="header">0.6.8</b> — <small><i>June 9, 2014</i></small>
                                <br/>
                                <p>Package.json fix for CLI.</p>
                            </div>
                            <div><b class="header">0.6.7</b> — <small><i>June 9, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Adds support for <a href="https://github.com/sidorares/node-mysql2">node-mysql2</a> library.</li>
                                    <li>Bundles CLI with the knex install, various related migrate CLI fixes.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.6</b> — <small><i>June 9, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>console.warn rather than throw when adding foreignKeys in SQLite3.</li>
                                    <li>Add support for dropColumn in SQLite3.</li>
                                    <li>Document <code>raw.wrap</code>.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.5</b> — <small><i>June 9, 2014</i></small>
                                <br/>
                                <p>Add missing _ require to WebSQL builds.</p>
                            </div>
                            <div><b class="header">0.6.4</b> — <small><i>June 9, 2014</i></small>
                                <br/>
                                <p>Fix &amp; document schema.raw method.</p>
                            </div>
                            <div><b class="header">0.6.3</b> — <small><i>June 6, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Schema methods on transaction object are now transaction aware ( <a href="https://github.com/tgriesser/knex/issues/301">#301</a>).</li>
                                    <li>Fix for resolved value from transactions, ( <a href="https://github.com/tgriesser/knex/issues/298">#298</a>).</li>
                                    <li>Undefined columns are not added to builder.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.2</b> — <small><i>June 4, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Fix regression in raw query output, ( <a href="https://github.com/tgriesser/knex/issues/297">#297</a>).</li>
                                    <li>Fix regression in &quot;pluck&quot; method ( <a href="https://github.com/tgriesser/knex/issues/296">#296</a>).</li>
                                    <li>Document <a href="#Builder-first">first</a> method.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.6.1</b> — <small><i>June 4, 2014</i></small>
                                <br/>
                                <p>Reverting to using .npmignore, the &quot;files&quot; syntax forgot the knex.js file</p>
                            </div>
                            <div><b class="header">0.6.0</b> — <small><i>June 4, 2014</i></small>
                                <br/><b>Major Library refactor:</b>
                                <ul>
                                    <li>Major internal overhaul to clean up the various dialect code.</li>
                                    <li>Improved unit test suite.</li>
                                    <li>Support for the <a href="https://github.com/mscdex/node-mariasql">mariasql</a> driver.</li>
                                    <li>More consistent use of raw query bindings throughout the library.</li>
                                    <li>Queries are more composable, may be injected in various points throughout the builder.</li>
                                    <li>Added <a href="#Interfaces-Streams">streaming</a> interface</li>
                                    <li>Deprecated 5 argument <a href="#Builder-join">join</a> in favor of additional join methods.</li>
                                    <li>The wrapValue function to allow for array column operations in PostgreSQL ( <a href="https://github.com/tgriesser/knex/issues/287">#287</a>).</li>
                                    <li>An explicit connection can be passed for any query ( <a href="https://github.com/tgriesser/knex/issues/56">#56</a>).</li>
                                    <li>Drop column support for sqlite3</li>
                                    <li>All schema actions are run sequentially on the same connection if chained.</li>
                                    <li>Schema actions can now be wrapped in a transaction</li>
                                    <li><code>.references(tableName.columnName)</code> as shorthand for <code>.references(columnName).inTable(tableName)</code></li>
                                    <li><code>.join(&#39;table.column&#39;, &#39;otherTable.column&#39;)</code> as shorthand for .join(&#39;table.column&#39;, &#39;=&#39;, &#39;otherTable.column&#39;)</li>
                                    <li>Streams are supported for selects, passing through to the streaming capabilities of node-mysql and node-postgres</li>
                                    <li>For More information, see this <a href="https://github.com/tgriesser/knex/pull/252">pull-request</a>.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.5.15</b> — <small><i>June 4, 2014</i></small>
                                <br/>
                                <p>Dropped indexes feature now functions correctly, ( <a href="https://github.com/tgriesser/knex/issues/278">#278</a>).</p>
                            </div>
                            <div><b class="header">0.5.14</b> — <small><i>May 6, 2014</i></small>
                                <br/>
                                <p>Remove the charset encoding if it&#39;s utf8 for mysql, as it&#39;s the default but also currently causes some issues in recent versions of node-mysql.</p>
                            </div>
                            <div><b class="header">0.5.13</b> — <small><i>April 2, 2014</i></small>
                                <br/>
                                <p>Fix regression in array bindings for postgresql ( <a href="https://github.com/tgriesser/knex/issues/228">#228</a>).</p>
                            </div>
                            <div><b class="header">0.5.12</b> — <small><i>Mar 31, 2014</i></small>
                                <br/>
                                <p>Add more operators for where clauses, including &amp;&amp; ( <a href="https://github.com/tgriesser/knex/issues/226">#226</a>).</p>
                            </div>
                            <div><b class="header">0.5.11</b> — <small><i>Mar 25, 2014</i></small>
                                <br/>
                                <ul>
                                    <li><code>.where(col, &#39;is&#39;, null)</code> or <code>.where(col, &#39;is not&#39;, null)</code> are not supported ( <a href="https://github.com/tgriesser/knex/issues/221">#221</a>).</li>
                                    <li>Case insensitive <code>where</code> operators now allowed ( <a href="https://github.com/tgriesser/knex/issues/212">#212</a>).</li>
                                    <li>Fix bug in increment/decrement truncating to an integer ( <a href="https://github.com/tgriesser/knex/issues/210">#210</a>).</li>
                                    <li>Disconnected connections are now properly handled &amp; removed from the pool ( <a href="https://github.com/tgriesser/knex/issues/206">#206</a>).</li>
                                    <li>Internal tweaks to binding concatenations for performance ( <a href="https://github.com/tgriesser/knex/issues/207">#207</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.5.10</b> — <small><i>Mar 19, 2014</i></small>
                                <br/>
                                <p>Add the .exec method to the internal promise shim.</p>
                            </div>
                            <div><b class="header">0.5.9</b> — <small><i>Mar 18, 2014</i></small>
                                <br/>
                                <p>Remove error&#39;ed connections from the connection pool ( <a href="https://github.com/tgriesser/knex/issues/206">#206</a>), added support for node-postgres-pure (pg.js) ( <a href="https://github.com/tgriesser/knex/issues/200">#200</a>).</p>
                            </div>
                            <div><b class="header">0.5.8</b> — <small><i>Feb 27, 2014</i></small>
                                <br/>
                                <p>Fix for chaining on forUpdate / forShare, adding map &amp; reduce from bluebird.</p>
                            </div>
                            <div><b class="header">0.5.7</b> — <small><i>Feb 18, 2014</i></small>
                                <br/>
                                <p>Fix for a null limit / offset breaking query chain ( <a href="https://github.com/tgriesser/knex/issues/182">#182</a>).</p>
                            </div>
                            <div><b class="header">0.5.6</b> — <small><i>Feb 5, 2014</i></small>
                                <br/>
                                <p>Bump bluebird dependency to ~1.0.0, fixing regression in Bluebird 1.0.2 ( <a href="https://github.com/tgriesser/knex/issues/176">#176</a>).</p>
                            </div>
                            <div><b class="header">0.5.5</b> — <small><i>Jan 28, 2014</i></small>
                                <br/>
                                <ul>
                                    <li>Fix for the exit code on the migrations cli ( <a href="https://github.com/tgriesser/knex/issues/151">#151</a>).</li>
                                    <li>The <code>init</code> method in <code>knex.migrate</code> now uses <code>this.config</code> if one isn&#39;t passed in ( <a href="https://github.com/tgriesser/knex/issues/156">#156</a>).</li>
                                </ul>
                            </div>
                            <div><b class="header">0.5.4</b> — <small><i>Jan 7, 2014</i></small>
                                <br/>
                                <p>Fix for using raw statements in defaultTo schema builder methods ( <a href="https://github.com/tgriesser/knex/issues/146">#146</a>).</p>
                            </div>
                            <div><b class="header">0.5.3</b> — <small><i>Jan 2, 2014</i></small>
                                <br/>
                                <p>Fix for incorrectly formed sql when aggregates are used with columns ( <a href="https://github.com/tgriesser/knex/issues/144">#144</a>).</p>
                            </div>
                            <div><b class="header">0.5.2</b> — <small><i>Dec 18, 2013</i></small>
                                <br/>
                                <p>Adding passthrough &quot;catch&quot;, &quot;finally&quot; to bluebird implementations, use bluebird&#39;s &quot;nodeify&quot; internally for exec.</p>
                            </div>
                            <div><b class="header">0.5.1</b> — <small><i>Dec 12, 2013</i></small>
                                <br/>
                                <ul>
                                    <li>The <a href="#Builder-returning">returning</a> in PostgreSQL may now accept * or an array of columns to return. If either of these are passed, the response will be an array of objects rather than an array of values. Updates may also now use a <code>returning</code> value. ( <a href="https://github.com/tgriesser/knex/issues/132">#132</a>)</li>
                                    <li>Added <code>bigint</code> and <code>bigserial</code> type to PostgreSQL. ( <a href="https://github.com/tgriesser/knex/issues/111">#111</a>)</li>
                                    <li>Fix for the <a href="#Schema-specificType">specificType</a> schema call ( <a href="https://github.com/tgriesser/knex/issues/118">#118</a>)</li>
                                    <li>Several fixes for migrations, including migration file path fixes, passing a Promise constructor to the migration <code>up</code> and <code>down</code> methods, allowing the &quot;knex&quot; module to be used globally, file ordering on migrations, and other small improvements. ( <a href="https://github.com/tgriesser/knex/issues/112">#112</a>-115, <a href="https://github.com/tgriesser/knex/issues/125">#125</a>, <a href="https://github.com/tgriesser/knex/issues/135">#135</a>)</li>
                                </ul>
                            </div>
                            <div><b class="header">0.5.0</b> — <small><i>Nov 25, 2013</i></small>
                                <br/>
                                <ul>
                                    <li>Initial pass at a <a href="#Migrations">migration</a> api.</li>
                                    <li>Aggregate methods are no longer aliased as &quot;aggregate&quot;, but may now be aliased and have more than one aggregate in a query ( <a href="https://github.com/tgriesser/knex/issues/108">#108</a>, <a href="https://github.com/tgriesser/knex/issues/110">#110</a>).</li>
                                    <li>Adding bigint and bigserial to PostgreSQL ( <a href="https://github.com/tgriesser/knex/issues/111">#111</a>).</li>
                                    <li>Bugfix on increment/decrement values ( <a href="https://github.com/tgriesser/knex/issues/100">#100</a>).</li>
                                    <li>Bugfix with having method ( <a href="https://github.com/tgriesser/knex/issues/107">#107</a>).</li>
                                    <li>Switched from when.js to <a href="https://github.com/petkaantonov/bluebird">bluebird</a> for promise implementation, with shim for backward compatibility.</li>
                                    <li>Switched from underscore to lodash, for semver reliability.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.4.13</b> — <small><i>Oct 31, 2013</i></small>
                                <br/>
                                <p>Fix for aggregate methods on toString and clone, ( <a href="https://github.com/tgriesser/knex/issues/98">#98</a>).</p>
                            </div>
                            <div><b class="header">0.4.12</b> — <small><i>Oct 29, 2013</i></small>
                                <br/>
                                <p>Fix incorrect values passed to float in MySQL and decimal in PostgreSQL.</p>
                            </div>
                            <div><b class="header">0.4.11</b> — <small><i>Oct 15, 2013</i></small>
                                <br/>
                                <p>Fix potential sql injection vulnerability in orderBy, thanks to @sebgie.</p>
                            </div>
                            <div><b class="header">0.4.10</b> — <small><i>Oct 14, 2013</i></small>
                                <br/>
                                <ul>
                                    <li>Added <a href="#Builder-forUpdate">forUpdate</a> and <a href="#Builder-forShare">forShare</a> for select modes in transactions. ( <a href="https://github.com/tgriesser/knex/issues/84">#84</a>)</li>
                                    <li>Fix bug where current query chain type is not copied on <a href="#Builder-clone">clone</a>. ( <a href="https://github.com/tgriesser/knex/issues/90">#90</a>)</li>
                                    <li>Charset and collate are now added as methods on the schema builder. ( <a href="https://github.com/tgriesser/knex/issues/89">#89</a>)</li>
                                    <li>Added <code>into</code> as an alias of <a href="#Builder-from">from</a>, for builder syntax of: <code>insert(value).into(tableName)</code></li>
                                    <li>Internal pool fixes. ( <a href="https://github.com/tgriesser/knex/issues/90">#90</a>)</li>
                                </ul>
                            </div>
                            <div><b class="header">0.4.9</b> — <small><i>Oct 7, 2013</i></small>
                                <br/>
                                <ul>
                                    <li>Fix for documentation of <a href="#Schema-hasColumn">hasColumn</a>, ensure that <code>hasColumn</code> works with MySQL ( <a href="https://github.com/tgriesser/knex/issues/87">#87</a>).</li>
                                    <li>More cleanup of error messages, showing the original error message concatenated with the sql and bindings.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.4.8</b> — <small><i>Oct 2, 2013</i></small>
                                <br/>
                                <p>Connections are no longer pushed back into the pool if they never existed to begin with ( <a href="https://github.com/tgriesser/knex/issues/85">#85</a>).</p>
                            </div>
                            <div><b class="header">0.4.7</b> — <small><i>Sep 27, 2013</i></small>
                                <br/>
                                <p>The column is now a documented method on the builder api, and takes either an individual column or an array of columns to select.</p>
                            </div>
                            <div><b class="header">0.4.6</b> — <small><i>Sep 25, 2013</i></small>
                                <br/>
                                <p>Standardizing handling of errors for easier debugging, as noted in ( <a href="https://github.com/tgriesser/knex/issues/39">#39</a>).</p>
                            </div>
                            <div><b class="header">0.4.5</b> — <small><i>Sep 24, 2013</i></small>
                                <br/>
                                <p>Fix for hasTable always returning true in MySQL ( <a href="https://github.com/tgriesser/knex/issues/82">#82</a>), fix where sql queries were duplicated with multiple calls on toSql with the schema builder.</p>
                            </div>
                            <div><b class="header">0.4.4</b> — <small><i>Sep 22, 2013</i></small>
                                <br/>
                                <p>Fix for debug method not properly debugging individual queries.</p>
                            </div>
                            <div><b class="header">0.4.3</b> — <small><i>Sep 18, 2013</i></small>
                                <br/>
                                <p>Fix for underscore not being defined in various grammar files.</p>
                            </div>
                            <div><b class="header">0.4.2</b> — <small><i>Sep 17, 2013</i></small>
                                <br/>
                                <p>Fix for an error being thrown when an initialized ClientBase instance was passed into Knex.initialize. pool.destroy now optionally accepts a callback to notify when it has completed draining and destroying all connections.</p>
                            </div>
                            <div><b class="header">0.4.1</b> — <small><i>Sep 16, 2013</i></small>
                                <br/>
                                <p>Cleanup from the 0.4.0 release, fix a potential exploit in &quot;where&quot; clauses pointed out by Andri Möll, fix for clients not being properly released from the pool <a href="https://github.com/tgriesser/knex/issues/70">#70</a>, fix for where(&quot;foo&quot;, &quot;&lt;&gt;&quot;, null) doing an &quot;IS NULL&quot; statement.</p>
                            </div>
                            <div><b class="header">0.4.0</b> — <small><i>Sep 13, 2013</i></small>
                                <br/><b>Breaking Changes:</b>
                                <ul>
                                    <li>Global state is no longer stored in the library, an instance is returned from <code>Knex.initialize</code>, so you will need to call this once and then reference this <code>knex</code> client elsewhere in your application.</li>
                                    <li>Lowercasing of <code>knex.raw</code>, <code>knex.transaction</code>, and <code>knex.schema</code>.</li>
                                    <li>Created columns are now nullable by default, unless <code>notNullable</code> is chained as an option.</li>
                                    <li>Keys created with <code>increments</code> are now assumed to be unsigned (MySQL) by default.</li>
                                    <li>The <code>destroyAllNow</code> is no longer called by the library on <code>process.exit</code> event. If you need to call it explicitly yourself, you may use <code>knex.client.destroyPool</code></li>
                                </ul>
                            </div>
                            <div><b class="header">0.2.6</b> — <small><i>Aug 29, 2013</i></small>
                                <br/>
                                <p>Reject the transaction promise if the transaction &quot;commit&quot; fails, ( <a href="https://github.com/tgriesser/knex/issues/50">#50</a>).</p>
                            </div>
                            <div><b class="header">0.2.5</b> — <small><i>Aug 25, 2013</i></small>
                                <br/>
                                <p>Fix error if a callback isn&#39;t specified for exec, ( <a href="https://github.com/tgriesser/knex/issues/49">#49</a>).</p>
                            </div>
                            <div><b class="header">0.2.4</b> — <small><i>Aug 22, 2013</i></small>
                                <br/>
                                <p>Fix SQLite3 delete not returning affected row count, ( <a href="https://github.com/tgriesser/knex/issues/45">#45</a>).</p>
                            </div>
                            <div><b class="header">0.2.3</b> — <small><i>Aug 22, 2013</i></small>
                                <br/>
                                <p>Fix insert with default values in PostgreSQL and SQLite3, ( <a href="https://github.com/tgriesser/knex/issues/44">#44</a>).</p>
                            </div>
                            <div><b class="header">0.2.2</b> — <small><i>Aug 20, 2013</i></small>
                                <br/>
                                <p>Allowing Raw queries to be passed as the primary table names.</p>
                            </div>
                            <div><b class="header">0.2.1</b> — <small><i>Aug 13, 2013</i></small>
                                <br/>
                                <p>Fix for an array passed to insert being mutated.</p>
                            </div>
                            <div><b class="header">0.2.0</b> — <small><i>Aug 7, 2013</i></small>
                                <br/><b>Breaking changes:</b>
                                <ul>
                                    <li><a href="#Schema-hasTable">hasTable</a> now returns a boolean rather than a failed promise.</li>
                                    <li>Changed syntax for insert in postgresql, where the <code>id</code> is not assumed on inserts ( <a href="https://github.com/tgriesser/knex/issues/18">#18</a>). The second parameter of <a href="#Builder-insert">insert</a> is now required to return an array of insert id&#39;s for the last insert.</li>
                                    <li>The <a href="#Schema-timestamp">timestamp</a> method on the schema builder now uses a <code>dateTime</code> rather than a <code>timestamp</code>.</li>
                                </ul>
                            </div>
                            <div><b class="header">0.1.8</b> — <small><i>July 7, 2013</i></small>
                                <br/>
                                <p>Somehow missing the != operator. Using <em>.find rather than </em>.where in getCommandsByName( <a href="https://github.com/tgriesser/knex/issues/22">#22</a>).</p>
                            </div>
                            <div><b class="header">0.1.7</b> — <small><i>June 12, 2013</i></small>
                                <br/>
                                <p>Ensures unhandled errors in the exec callback interface are re-thrown.</p>
                            </div>
                            <div><b class="header">0.1.6</b> — <small><i>June 9, 2013</i></small>
                                <br/>
                                <p>Renaming beforeCreate to afterCreate. Better handling of errors in the connection pooling.</p>
                            </div>
                            <div><b class="header">0.1.5</b> — <small><i>June 9, 2013</i></small>
                                <br/>
                                <p>Added the ability to specify beforeCreate and beforeDestroy hooks on the initialize&#39;s options.pool to perform any necessary database setup/teardown on connections before use ( <a href="https://github.com/tgriesser/knex/issues/14">#14</a>). where and having may now accept Knex.Raw instances, for consistency ( <a href="https://github.com/tgriesser/knex/issues/15">#15</a>). Added an orHaving method to the builder. The ability to specify bindings on Raw queries has been removed.</p>
                            </div>
                            <div><b class="header">0.1.4</b> — <small><i>May 22, 2013</i></small>
                                <br/>
                                <p>defaultTo now accepts &quot;false&quot; for boolean columns, allows for empty strings as default values.</p>
                            </div>
                            <div><b class="header">0.1.3</b> — <small><i>May 18, 2013</i></small>
                                <br/>
                                <p>Enabling table aliases ( <a href="https://github.com/tgriesser/knex/issues/11">#11</a>). Fix for issues with transactions not functioning ( <a href="https://github.com/tgriesser/knex/issues/12">#12</a>).</p>
                            </div>
                            <div><b class="header">0.1.2</b> — <small><i>May 15, 2013</i></small>
                                <br/>
                                <p>Bug fixes for groupBy ( <a href="https://github.com/tgriesser/knex/issues/7">#7</a>). Mysql using collation, charset config settings in createTable. Added engine on schemaBuilder specifier ( <a href="https://github.com/tgriesser/knex/issues/6">#6</a>). Other doc fixes, tests.</p>
                            </div>
                            <div><b class="header">0.1.1</b> — <small><i>May 14, 2013</i></small>
                                <br/>
                                <p>Bug fixes for sub-queries, minor changes to initializing &quot;main&quot; instance, adding &quot;pg&quot; as a valid parameter for the client name in the connection settings.</p>
                            </div>
                            <div><b class="header">0.1.0</b> — <small><i>May 13, 2013</i></small>
                                <br/>
                                <p>Initial Knex release.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="/build/bundle.js"></script>

</html>